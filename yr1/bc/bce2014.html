<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALIF | Advanced Medical Education</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="/protect.js"></script>
    <style type="text/css">
        /* Import Inter font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        :root {
            --primary: #3b82f6; 
            --primary-dark: #2563eb; 
            --primary-light: #dbeafe; 
            --secondary: #6b7280; 
            --success: #22c55e; 
            --error: #ef4444; 
            --warning: #eab308; 
            --info: #0ea5e9; 
            --background: #ffffff; 
            --surface: #f9fafb; 
            --text-primary: #111827; 
            --text-secondary: #4b5563; 
            --text-tertiary: #9ca3af; 
            --border: #e5e7eb; 
            --shadow: 0 2px 4px rgba(0, 0, 0, 0.05); 
            --shadow-lg: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 8px 16px rgba(0, 0, 0, 0.05);
            --radius: 8px; 
            --radius-lg: 12px;
            --radius-xl: 16px;
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); 
            --gradient: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            --glass: rgba(255, 255, 255, 0.85); 
            --glass-border: rgba(229, 231, 235, 0.3);
        }

        .dark-mode {
            --primary: #60a5fa;
            --primary-dark: #3b82f6;
            --primary-light: #93c5fd;
            --secondary: #94a3b8;
            --background: #000000; 
            --surface: #111827; 
            --text-primary: #f9fafb; 
            --text-secondary: #d1d5db; 
            --text-tertiary: #6b7280; 
            --border: #1f2937; 
            --shadow: 0 2px 4px rgba(0, 0, 0, 0.6); 
            --shadow-lg: 0 4px 8px rgba(0, 0, 0, 0.6);
            --shadow-xl: 0 8px 16px rgba(0, 0, 0, 0.6);
            --glass: rgba(17, 24, 39, 0.85); 
            --glass-border: rgba(31, 41, 55, 0.3);
            .mode-btn,
    .question-text,
    .option-text {
        color: var(--text-primary) !important;
    }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none; 
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* App Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--surface);
            border-right: 1px solid var(--border);
            padding: 24px 0;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: var(--shadow);
            transform: translateX(-100%);
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 0 24px 16px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 22px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .logo i {
            font-size: 24px;
        }

        .sidebar-subtitle {
            font-size: 13px;
            color: var(--text-tertiary);
            font-weight: 400;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 24px;
            margin-bottom: 24px;
            background: var(--glass);
            border-radius: var(--radius);
            margin: 0 16px 24px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            box-shadow: var(--shadow);
        }

        .user-info h3 {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .user-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--glass);
            border-left-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .nav-item.active {
            background: var(--primary-light);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-item.active .nav-icon {
            color: var(--primary);
        }

        .nav-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
        }

        .categories-section {
            margin-top: 24px;
        }

        .section-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .categories-grid {
            padding: 0 16px;
        }

        .category-card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .category-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        .category-card.active {
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .category-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
        }

        .category-card.active .category-icon {
            background: var(--primary);
        }

        .category-name {
            font-weight: 500;
            font-size: 14px;
        }

        .category-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
            margin-right: 8px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 2px;
            transition: width 0.4s ease;
        }

        .progress-text {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .category-card.active .progress-text {
            color: var(--primary);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 0;
            transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .main-content.sidebar-open {
            margin-left: 280px;
        }

        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 32px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .menu-toggle {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-primary);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius);
            transition: var(--transition);
        }

        .menu-toggle:hover {
            background: var(--primary-light);
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .mode-selector {
            display: flex;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 4px;
        }

        .mode-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .mode-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            padding: 24px 32px;
        }

        .stat-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .stat-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Quiz Container */
        .quiz-container {
            padding: 0 32px 32px;
        }

        .question-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .question-card.fade-in {
            opacity: 1;
        }

        .question-card:hover {
            box-shadow: var(--shadow-lg);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .question-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .question-number {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
            background: var(--primary-light);
            padding: 6px 12px;
            border-radius: 16px;
        }

        .question-category {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            background: var(--glass);
            padding: 6px 12px;
            border-radius: 16px;
        }

        .question-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: var(--glass);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-secondary);
        }

        .action-btn:hover {
            background: var(--primary-light);
            color: var(--primary);
            border-color: var(--primary-light);
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            line-height: 1.6;
            margin-bottom: 24px;
            color: var(--text-primary);
            overflow-x: auto;
        }

        .question-text table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
            text-align: left;
            overflow-x: auto;
            display: block;
        }

        .question-text th, .question-text td {
            padding: 12px;
            border: 1px solid var(--border);
        }

        .question-text th {
            background-color: var(--surface);
            font-weight: bold;
        }

        .question-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass);
            min-height: 60px;
        }

        .option:hover {
            border-color: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(34, 197, 94, 0.05);
        }

        .option.incorrect {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.05);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--surface);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: var(--text-secondary);
            flex-shrink: 0;
            transition: var(--transition);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--success);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--error);
            color: white;
        }

        .option-text {
            flex: 1;
            font-size: 15px;
            font-weight: 400;
        }

        /* Explanation Section */
        .explanation-section {
            margin-top: 24px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 24px;
        }

        .explanation-section details {
            margin-bottom: 16px;
        }

        .explanation-section summary {
            padding: 12px 16px;
            background: var(--surface);
            cursor: pointer;
            font-weight: 500;
            font-size: 15px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .explanation-section summary:hover {
            background: var(--primary-light);
        }

        .explanation-section details[open] summary {
            background: var(--primary);
            color: white;
        }

        .explanation-content {
            padding: 16px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .explanation-content strong {
            color: var(--text-primary);
        }

        .correct-answer, .why-not-section, .related-questions {
            margin-bottom: 16px;
            padding: 16px;
            border-radius: var(--radius);
        }

        .correct-answer {
            background: rgba(34, 197, 94, 0.05);
            border-left: 4px solid var(--success);
        }

        .why-not-section {
            background: rgba(239, 68, 68, 0.05);
            border-left: 4px solid var(--error);
        }

        .related-questions {
            background: rgba(59, 130, 246, 0.05);
            border-left: 4px solid var(--primary);
        }

        .related-questions-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .related-question-tag {
            padding: 6px 12px;
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary);
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .related-question-tag:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateY(-1px);
        }

        /* Quiz Controls */
        .quiz-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .quiz-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .quiz-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .quiz-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .check-btn {
            background: var(--primary);
            color: white;
        }

        .check-btn:hover:not(:disabled) {
            background: var(--primary-dark);
        }

        .next-btn {
            background: var(--success);
            color: white;
        }

        .next-btn:hover:not(:disabled) {
            background: #16a34a;
        }

        .submit-btn {
            background: var(--gradient);
            color: white;
            padding: 12px 32px;
            font-size: 16px;
        }

        /* Results Screen */
        .results-screen {
            padding: 32px;
            max-width: 900px;
            margin: 0 auto;
        }

        .results-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 48px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .results-header {
            margin-bottom: 32px;
        }

        .results-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .score-display {
            font-size: 64px;
            font-weight: 700;
            margin: 32px 0;
            color: var(--text-primary);
        }

        .score-text {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 32px;
        }

        .results-details {
            text-align: left;
            margin: 48px 0;
            background: var(--glass);
            border-radius: var(--radius);
            padding: 24px;
            border: 1px solid var(--glass-border);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-question {
            flex: 1;
            font-size: 14px;
        }

        .result-status {
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .result-correct {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .result-incorrect {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .restart-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 16px 48px;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 999;
            display: none;
            transition: opacity 0.3s ease;
        }

        .overlay.active {
            display: block;
            opacity: 1;
        }

        /* Enhanced Features */
        .search-container {
            padding: 16px 32px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 12px 16px;
            max-width: 400px;
            margin: 0 auto;
        }

        .search-box input {
            flex: 1;
            border: none;
            background: transparent;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
        }

        .search-box i {
            color: var(--text-tertiary);
            margin-right: 8px;
        }


        .export-section {
            padding: 16px 32px;
            text-align: center;
        }

        .export-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        /* Custom Quiz Modal Styles */
        .custom-quiz-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .custom-quiz-modal.active {
            display: flex;
        }

        .custom-quiz-content {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border);
        }

        .custom-quiz-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-primary);
        }

        .custom-quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .custom-quiz-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass);
        }

        .custom-quiz-option:hover {
            border-color: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .custom-quiz-option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .custom-quiz-option .option-selector {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .custom-quiz-option.selected .option-selector {
            background: var(--primary);
            border-color: var(--primary);
        }

        .custom-quiz-option.selected .option-selector::after {
            content: 'âœ“';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .custom-quiz-option label {
            cursor: pointer;
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
            margin: 0;
        }

        .quiz-options-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .quiz-options-section label {
            display: block;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .custom-quiz-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        /* Modern Dropdown for Custom Quiz */
        .custom-quiz-content .modern-dropdown {
            position: relative;
            margin-top: 8px;
        }

        .custom-quiz-content .modern-dropdown select {
            width: 100%;
            padding: 12px 48px 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            background: var(--surface);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 18px;
        }

        .custom-quiz-content .modern-dropdown select:hover {
            border-color: var(--primary);
            background-color: var(--primary-light);
        }

        .custom-quiz-content .modern-dropdown select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Glass effect for modal */
        .custom-quiz-content.glass-effect {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .dark-mode .custom-quiz-content.glass-effect {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .sidebar {
                width: 66vw;
            }

            .main-content.sidebar-open {
                margin-left: 100vw;
            }

            .top-nav {
                padding: 12px 16px;
                flex-wrap: wrap;
                gap: 12px;
            }

            .nav-left {
                width: 100%;
                justify-content: space-between;
            }

            .nav-right {
                width: 100%;
                justify-content: space-between;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                padding: 16px;
            }

            .quiz-container {
                padding: 0 16px 16px;
            }

            .question-card {
                padding: 24px;
            }

            .question-text {
                font-size: 17px;
            }

            .option {
                padding: 12px;
                min-height: 70px;
            }

            .results-card {
                padding: 32px 24px;
            }

            .score-display {
                font-size: 48px;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .search-container {
                padding: 12px 16px;
            }

            .analytics-section {
                margin: 16px;
                padding: 16px;
            }

            .quiz-btn {
                padding: 16px 20px;
                font-size: 16px;
            }
        }

        @media (min-width: 1200px) {
            .quiz-container {
                max-width: 1100px;
                margin: 0 auto;
                padding: 24px;
            }

            .question-card {
                max-width: 1000px;
                margin: 0 auto 24px;
            }
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        .hidden {
            display: none;
        }

        .glass {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
        }

        .text-gradient {
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .question-difficulty {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            color: white;
        }

        .question-dropdown {
            margin-top: 8px;
            display: block;
        }

        .question-dropdown select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--surface);
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
        }

        .option.disabled {
            pointer-events: none;
            opacity: 0.6;
            cursor: not-allowed;
        }

        .timer-warning {
            color: var(--warning);
        }

        .timer-error {
            color: var(--error);
        }

        .loading-spinner {
            display: none;
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }

        .loading-spinner.active {
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Ultra Modern Styles */
        /* Glass Morphism Effects */
        .glass-effect {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark-mode .glass-effect {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Enhanced Hover Effects with Glow */
        .nav-item:hover {
            background: linear-gradient(135deg, var(--primary-light) 0%, rgba(59, 130, 246, 0.15) 100%) !important;
            border-left-color: var(--primary) !important;
            transform: translateX(8px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.25) !important;
            backdrop-filter: blur(10px);
        }

        .category-card:hover {
            background: linear-gradient(135deg, var(--glass) 0%, rgba(255, 255, 255, 0.95) 100%) !important;
            transform: translateY(-5px) scale(1.03) !important;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15), 0 0 30px rgba(59, 130, 246, 0.1) !important;
            border-color: var(--primary) !important;
            backdrop-filter: blur(10px);
        }

        .option:hover {
            background: linear-gradient(135deg, var(--primary-light) 0%, rgba(59, 130, 246, 0.12) 100%) !important;
            transform: translateY(-3px) scale(1.03) !important;
            box-shadow: 0 12px 30px rgba(59, 130, 246, 0.2) !important;
            border-color: var(--primary) !important;
        }

        .quiz-btn:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.08) !important;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25) !important;
            filter: brightness(1.1);
        }

        .action-btn:hover {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%) !important;
            color: white !important;
            transform: scale(1.15) rotate(8deg) !important;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.5) !important;
        }

        /* Ultra Modern Dropdown */
        .modern-dropdown {
            position: relative;
            margin-top: 12px;
        }

        .modern-dropdown select {
            width: 100%;
            padding: 12px 48px 12px 16px;
            border: 2px solid transparent;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--surface) 0%, var(--glass) 100%);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 18px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
        }

        .modern-dropdown select:hover {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary-light) 0%, rgba(59, 130, 246, 0.08) 100%);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }

        .modern-dropdown select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15), 0 8px 25px rgba(59, 130, 246, 0.25);
            transform: translateY(-2px);
        }

        /* Enhanced Search with Blur Effect */
        .search-container {
            transition: all 0.4s ease;
        }

        .search-box {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .search-box:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.2);
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.15);
        }

        .search-blur-active .main-content > *:not(.search-container):not(.quiz-container) {
            filter: blur(8px);
            opacity: 0.7;
            pointer-events: none;
        }

        /* Beautiful Stats Cards */
        .stat-card {
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.05) !important;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2) !important;
        }

        /* Modern Progress Bars */
        .progress-fill {
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark), #8b5cf6) !important;
            box-shadow: 0 2px 12px rgba(59, 130, 246, 0.4);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Beautiful Notification */
        .notification {
            border-radius: 20px !important;
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-weight: 600;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3) !important;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.15)) !important;
        }

        .dark-mode .notification {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.2)) !important;
        }

        /* Enhanced Question Cards */
        .question-card {
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .question-card:hover {
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15) !important;
            transform: translateY(-3px);
            border-color: var(--primary-light);
        }

        /* Modern Settings Panel */
        .settings-panel {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
        }

        .dark-mode .settings-panel {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Custom Question Creator */
        .custom-question-creator {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 32px;
        }

        .dark-mode .custom-question-creator {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: scale(1.15) rotate(15deg);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.6);
        }

        /* Dark mode adjustments */
        .dark-mode .nav-item:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.25) 0%, rgba(59, 130, 246, 0.1) 100%) !important;
        }

        .dark-mode .category-card:hover {
            background: linear-gradient(135deg, var(--glass) 0%, rgba(17, 24, 39, 0.95) 100%) !important;
        }

        .dark-mode .option:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(59, 130, 246, 0.08) 100%) !important;
        }

        /* Search Results Highlight */
        .search-highlight {
            background: linear-gradient(120deg, var(--primary-light) 0%, transparent 50%);
            border-radius: 4px;
            padding: 2px 4px;
        }
        @media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 12px 16px;
    }

    .stat-card {
        padding: 16px 12px;
        min-height: 80px;
    }

    .stat-header {
        margin-bottom: 8px;
        flex-wrap: wrap;
    }

    .stat-icon {
        width: 28px;
        height: 28px;
        font-size: 14px;
    }

    .stat-value {
        font-size: 20px;
        margin-bottom: 2px;
    }

    .stat-label {
        font-size: 11px;
        line-height: 1.3;
    }

    .stat-trend {
        font-size: 10px;
    }

    .stat-trend i {
        font-size: 10px;
    }
}

/* Extra small devices (phones under 400px) */
@media (max-width: 400px) {
    .stats-grid {
        grid-template-columns: 1fr;
        gap: 10px;
        padding: 10px 12px;
    }

    .stat-card {
        padding: 14px 10px;
        min-height: 70px;
    }

    .stat-value {
        font-size: 18px;
    }

    .stat-label {
        font-size: 10px;
    }
}
.analytics-grid {
    display: none;
}

/* OR hide individual cards */
.analytics-card {
    display: none;
}

/* If you want to keep the section structure but hide content */
.analytics-section {
    padding: 0;
    margin: 0;
    height: 0;
    overflow: hidden;
}
@media (max-width: 768px) {
    /* Your existing mobile styles... */
    
    .sidebar {
        width: 66vw;
    }

    .main-content.sidebar-open {
        margin-left: 100vw;
    }

    .top-nav {
        padding: 12px 16px;
        flex-wrap: wrap;
        gap: 12px;
    }

    /* Hide all custom question and export buttons on mobile */
    .fab {
        display: none !important;
    }
    
    #createCustomQuizBtn {
        display: none !important;
    }
    
    /* Hide both buttons in Settings section */
    .settings-panel .quiz-btn:has(i.fa-download),
    .settings-panel .quiz-btn:has(i.fa-plus) {
        display: none !important;
    }

    /* Your stats grid and other mobile styles... */
    .stats-grid {
        display: flex;
        overflow-x: auto;
        gap: 6px;
        padding: 6px 10px;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        margin: 0 -4px;
    }
    /* ... rest of your mobile CSS */
}
@media (max-width: 768px) {
    .fab {
        display: none !important;
    }
    
    /* Hide entire export section from Dashboard */
    .export-section {
        display: none !important;
    }
    
    /* Hide both buttons in Settings section */
    .settings-panel .quiz-btn:has(i.fa-download),
    .settings-panel .quiz-btn:has(i.fa-plus) {
        display: none !important;
    }
}
@media (max-width: 768px) {
    /* Hide all stat cards except Correct Answers */
    .stat-card:not(:first-child) {
        display: none !important;
    }
    
    /* Optional: Make the Correct Answers card full width */
    .stat-card:first-child {
        width: 100% !important;
        flex: 1 !important;
    }

    /* Your existing mobile styles for stats grid */
    .stats-grid {
        display: flex;
        overflow-x: auto;
        gap: 6px;
        padding: 6px 10px;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        margin: 0 -4px;
    }
}
.user-avatar img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
}
/* Primary action button */
.action-btn.primary {
    background: var(--primary);
    color: white;
}

.action-btn.primary:hover {
    background: var(--primary-dark);
    transform: scale(1.1);
}
/* Responsive Images */
.question-image {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 16px 0;
    display: block;
    box-shadow: var(--shadow);
}

.question-image-container {
    width: 100%;
    text-align: center;
    margin: 16px 0;
}

/* Ensure images don't overflow their containers */
.question-image-container img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    box-shadow: var(--shadow);
}

/* Responsive Tables */
.question-text table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 14px;
    text-align: left;
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    -webkit-overflow-scrolling: touch;
    border-radius: var(--radius);
    background: var(--surface);
}

.question-text th, .question-text td {
    padding: 12px;
    border: 1px solid var(--border);
    min-width: 120px; /* Prevents columns from becoming too narrow */
}

.question-text th {
    background-color: var(--surface);
    font-weight: bold;
    position: sticky;
    left: 0;
    color: var(--text-primary);
}

.question-text td {
    color: var(--text-secondary);
    background: var(--background);
}

/* Responsive Question Cards */
.question-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 20px;
    margin-bottom: 16px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    width: 100%;
    overflow: hidden;
}

.question-card:hover {
    box-shadow: var(--shadow-lg);
}

/* Mobile-specific adjustments */
@media (max-width: 768px) {
    /* Question card mobile optimization */
    .question-card {
        padding: 16px;
        margin-bottom: 12px;
        border-radius: var(--radius);
    }
    
    .question-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
    }
    
    .question-meta {
        flex-wrap: wrap;
        gap: 8px;
        width: 100%;
    }
    
    .question-actions {
        align-self: flex-end;
        margin-top: -40px; /* Position actions at top right */
        position: relative;
        z-index: 2;
    }
    
    .question-text {
        font-size: 16px;
        line-height: 1.5;
        margin-bottom: 20px;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    
    /* Image mobile optimization */
    .question-image {
        margin: 12px 0;
        border-radius: 6px;
    }
    
    .question-image-container {
        margin: 12px 0;
    }
    
    /* Table mobile optimization */
    .question-text table {
        font-size: 12px;
        margin: 12px 0;
        border-radius: 6px;
    }
    
    .question-text th, .question-text td {
        padding: 8px 10px;
        min-width: 100px;
    }
    
    /* Options grid mobile optimization */
    .options-grid {
        grid-template-columns: 1fr;
        gap: 10px;
    }
    
    .option {
        padding: 14px;
        min-height: auto;
    }
    
    .option-letter {
        width: 28px;
        height: 28px;
        font-size: 13px;
    }
    
    .option-text {
        font-size: 14px;
        line-height: 1.4;
    }
    
    /* Quiz controls mobile optimization */
    .quiz-controls {
        flex-direction: column;
        gap: 12px;
        margin-top: 24px;
        padding-top: 20px;
    }
    
    .quiz-btn {
        width: 100%;
        justify-content: center;
        padding: 14px 20px;
        font-size: 15px;
    }
    
    /* Explanation section mobile optimization */
    .explanation-section {
        margin-top: 20px;
        padding: 16px;
    }
    
    .explanation-section summary {
        padding: 10px 12px;
        font-size: 14px;
    }
    
    .explanation-content {
        padding: 12px;
        font-size: 13px;
        line-height: 1.5;
    }
}

/* Extra small devices optimization (phones under 480px) */
@media (max-width: 480px) {
    .question-card {
        padding: 12px;
        margin-bottom: 10px;
    }
    
    .question-text {
        font-size: 15px;
        line-height: 1.4;
    }
    
    /* Image optimization for very small screens */
    .question-image {
        margin: 10px 0;
        border-radius: 4px;
    }
    
    .question-image-container {
        margin: 10px 0;
    }
    
    /* Table optimization for very small screens */
    .question-text table {
        font-size: 11px;
        margin: 10px 0;
    }
    
    .question-text th, .question-text td {
        padding: 6px 8px;
        min-width: 80px;
    }
    
    .question-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
    }
    
    .question-number, .question-category, .question-difficulty {
        font-size: 11px;
        padding: 4px 8px;
    }
    
    .option {
        padding: 12px 10px;
    }
    
    .option-text {
        font-size: 13px;
    }
    
    .action-btn {
        width: 36px;
        height: 36px;
        font-size: 14px;
    }
    
    /* Ensure proper spacing in exam mode */
    .exam-mode-layout .question-card {
        margin-bottom: 16px;
    }
}

/* Fix for exam mode layout on mobile */
.exam-mode-layout {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

@media (max-width: 768px) {
    .exam-mode-layout {
        gap: 12px;
    }
    
    .exam-header {
        padding: 16px;
    }
    
    .exam-header > div:first-child {
        flex-direction: column;
        gap: 16px;
    }
    
    .exam-mode-toggle {
        align-self: stretch;
        display: flex;
    }
    
    .mode-toggle-btn {
        flex: 1;
        text-align: center;
        font-size: 12px;
        padding: 10px 8px;
    }
    
    .progress-info {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
    }
    
    .progress-info .progress-bar {
        width: 100%;
    }
}

/* Fix for learn mode responsiveness */
@media (max-width: 768px) {
    .explanation-section {
        padding: 16px;
    }
    
    .explanation-section summary {
        padding: 10px 12px;
        font-size: 14px;
    }
    
    .explanation-content {
        padding: 12px;
        font-size: 13px;
    }
    
    .related-questions-list {
        flex-wrap: wrap;
        gap: 6px;
    }
    
    .related-question-tag {
        font-size: 11px;
        padding: 4px 8px;
    }
    
    .correct-answer, .why-not-section, .related-questions {
        padding: 12px;
        margin-bottom: 12px;
    }
}

/* Prevent horizontal scrolling on the entire page */
@media (max-width: 768px) {
    body {
        overflow-x: hidden;
    }
    
    .quiz-container {
        padding: 0 16px 16px;
    }
    
    .main-content {
        width: 100%;
    }
}

/* Ensure images in custom questions are also responsive */
.custom-question-creator img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 10px 0;
    display: block;
}

/* Fix for image loading states */
.question-image {
    background: var(--surface);
    min-height: 50px;
}

.question-image:not([src]) {
    display: none;
}

/* Animation for image loading */
@keyframes imageFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.question-image.loaded {
    animation: imageFadeIn 0.3s ease-in;
}
    </style>
</head>
<body class="dark-mode">
    <div class="overlay" id="overlay"></div>
    
    <!-- Custom Quiz Modal -->
<div class="custom-quiz-modal" id="customQuizModal">
    <div class="custom-quiz-content glass-effect">
        <h3 class="custom-quiz-title">Create Custom Quiz</h3>
        <div class="custom-quiz-options">
            <div class="custom-quiz-option" data-category="all">
                <div class="option-selector"></div>
                <label>All Categories</label>
            </div>
            <div class="custom-quiz-option" data-category="easy">
                <div class="option-selector"></div>
                <label>Easy Questions Only</label>
            </div>
            <div class="custom-quiz-option" data-category="medium">
                <div class="option-selector"></div>
                <label>Medium Questions Only</label>
            </div>
            <div class="custom-quiz-option" data-category="hard">
                <div class="option-selector"></div>
                <label>Hard Questions Only</label>
            </div>
            <div class="custom-quiz-option" data-category="bookmarked">
                <div class="option-selector"></div>
                <label>Bookmarked Questions Only</label>
            </div>
            <div class="quiz-options-section">
                <label>Number of Questions</label>
                <div class="modern-dropdown">
                    <select id="questionCount">
                        <option value="5">5 Questions</option>
                        <option value="10" selected>10 Questions</option>
                        <option value="15">15 Questions</option>
                        <option value="20">20 Questions</option>
                        <option value="0">All Questions</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="custom-quiz-actions">
            <button class="quiz-btn" id="cancelCustomQuiz">
                Cancel
            </button>
            <button class="quiz-btn check-btn" id="createCustomQuiz">
                Create Quiz
            </button>
        </div>
    </div>
</div>
    
    <!-- Main App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-stethoscope"></i>
                    <span>ALIF</span>
                </div>
                <div class="sidebar-subtitle">Advanced Medical Education Platform</div>
            </div>
            
            <div class="user-profile">
    <div class="user-avatar">
        <img src="logo.png" alt="User Avatar">
    </div>
    <div class="user-info">
        <h3>ALIFO</h3>
        <p>Medical Student</p>
    </div>
</div>

            
            <div class="nav-item active">
                <div class="nav-icon">
                    <i class="fas fa-home"></i>
                </div>
                <span>Dashboard</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <span>My Courses</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <span>Progress Analytics</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <i class="fas fa-bookmark"></i>
                </div>
                <span>Bookmarked Questions</span>
            </div>
            <div class="nav-item">
                <div class="nav-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <span>Settings</span>
            </div>
            
            <div class="categories-section">
                <div class="section-title">
                    <span>Medical Categories</span>
                    <i class="fas fa-sliders-h"></i>
                </div>
                <div class="categories-grid" id="categoriesGrid"></div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Top Navigation -->
            <div class="top-nav">
    <div class="nav-left">
        <button class="menu-toggle" id="menuToggle" aria-label="Toggle Sidebar">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Add Back and Home buttons -->
        <a href="/" class="action-btn" id="backBtn">
            <i class="fas fa-arrow-left"></i>
        </a>
        <a href="/" class="action-btn primary">
            <i class="fas fa-home"></i>
        </a>
        
        <h1 class="page-title" id="pageTitle">Dashboard</h1>
    </div>
    <div class="nav-right">
        <!-- Your existing mode selector and buttons -->
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="exam" aria-label="Exam Mode">
                <i class="fas fa-file-alt"></i>
                Exam
            </button>
            <button class="mode-btn" data-mode="quiz" aria-label="Quiz Mode">
                <i class="fas fa-tasks"></i>
                Quiz
            </button>
            <button class="mode-btn" data-mode="learn" aria-label="Learn Mode">
                <i class="fas fa-brain"></i>
                Learn
            </button>
        </div>
        <div class="action-btn" id="themeToggle" aria-label="Toggle Theme">
            <i class="fas fa-sun"></i>
        </div>
        <div class="action-btn" aria-label="Notifications">
            <i class="fas fa-bell"></i>
        </div>
    </div>
</div>
            
            <!-- Search Section -->
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search questions or categories...">
                </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card fade-in">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-trend">
                            <i class="fas fa-arrow-up" style="color: var(--success);"></i>
                            <span style="color: var(--success); font-size: 13px;">+12%</span>
                        </div>
                    </div>
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">Correct Answers</div>
                </div>
                <div class="stat-card fade-in">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-trend">
                            <i class="fas fa-arrow-down" style="color: var(--error);"></i>
                            <span style="color: var(--error); font-size: 13px;">-5%</span>
                        </div>
                    </div>
                    <div class="stat-value" id="timeSpent">0h</div>
                    <div class="stat-label">Time Spent</div>
                </div>
                <div class="stat-card fade-in">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-trend">
                            <i class="fas fa-arrow-up" style="color: var(--success);"></i>
                            <span style="color: var(--success); font-size: 13px;">+8%</span>
                        </div>
                    </div>
                    <div class="stat-value" id="masteryLevel">0%</div>
                    <div class="stat-label">Mastery Level</div>
                </div>
                <div class="stat-card fade-in">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="stat-trend">
                            <i class="fas fa-arrow-up" style="color: var(--warning);"></i>
                            <span style="color: var(--warning); font-size: 13px;">+3</span>
                        </div>
                    </div>
                    <div class="stat-value" id="streakCount">0</div>
                    <div class="stat-label">Day Streak</div>
                </div>
            </div>
            
            <!-- Analytics Section -->
            <div class="analytics-section">
                <h3 class="analytics-title">Learning Analytics</h3>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <div class="analytics-value" id="weakAreasCount">0</div>
                        <div class="analytics-label">Weak Areas Identified</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-value" id="avgTimePerQuestion">0s</div>
                        <div class="analytics-label">Avg Time Per Question</div>
                    </div>
                    <div class="analytics-card">
                        <div class="analytics-value" id="improvementRate">0%</div>
                        <div class="analytics-label">Weekly Improvement</div>
                    </div>
                </div>
            </div>
            
            <!-- Quiz Container -->
            <div class="quiz-container" id="quizContainer"></div>
            
            <!-- Results Screen -->
            <div class="results-screen hidden" id="resultsScreen"></div>
            
            <!-- Export Section -->
            <div class="export-section">
                <button class="export-btn" id="exportProgress">
                    <i class="fas fa-download"></i>
                     
                </button>
                <button class="export-btn" id="createCustomQuizBtn" style="margin-left: 12px;">
                    <i class="fas fa-plus"></i>
                     
                </button>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  // Check if running inside Telegram
  const tg = window.Telegram?.WebApp;

  // --- 1ï¸âƒ£ Handle Telegram Mini App Back Button ---
  if (tg) {
    tg.ready(); // Initialize Telegram SDK
    tg.BackButton.show();

    tg.BackButton.onClick(() => {
      console.log("Telegram back button pressed");
      handleBackAction();
    });
  }

  // --- 2ï¸âƒ£ Handle Browser/Phone Back Button ---
  window.addEventListener('popstate', () => {
    console.log("Browser back button pressed");
    handleBackAction();
  });

  // --- 3ï¸âƒ£ Function to handle back action globally ---
  function handleBackAction() {
    // Example actions (customize as you wish):
    // Go back if possible, otherwise go to home page
    if (document.referrer && window.history.length > 1) {
      window.history.back();
    } else {
      window.location.href = '/'; // or your home page route
    }
  }

  // --- 4ï¸âƒ£ Optional: Prevent unwanted exits ---
  // This ensures pressing back doesnâ€™t immediately close the app
  history.pushState(null, '', location.href);
</script>

     <script>
        // Anti-copy, anti-inspect measures
document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
});
document.addEventListener('keydown', function(e) {
    if (e.keyCode === 123 || (e.ctrlKey && e.shiftKey && e.keyCode === 73) || (e.ctrlKey && e.shiftKey && e.keyCode === 74) || (e.ctrlKey && e.keyCode === 85)) {
        e.preventDefault();
    }
});

// Enhanced quiz data with more questions
const quizData =


[
    {
        "id": 1,
        "question": "Which of the following is a carbohydrate?",
        "options": [
            "Arginine",
            "Fructose",
            "Methionine",
            "Maltose"
        ],
        "answer": 1,
        "correctAnswer": "Fructose",
        "explanation": "Fructose is a monosaccharide, a type of carbohydrate. Maltose is also a carbohydrate (disaccharide), but since the question asks for a single answer, fructose is correct. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 240.",
        "whyNotOtherOptions": {
            "a": "Arginine is an amino acid.",
            "c": "Methionine is an amino acid.",
            "d": "Maltose is a carbohydrate, but fructose is the primary monosaccharide listed."
        },
        "relatedQuestions": ["2 (glucose)", "4 (galactose oxidation)"],
        "category": "Carbohydrates",
        "difficulty": "Easy"
    },
    {
        "id": 2,
        "question": "Glucose consists of",
        "options": [
            "Glycine, arginine, and methionine",
            "Glycine, cysteine, and glutamate",
            "Glycine, histidine, and methionine",
            "Glycine, cysteine, and methionine"
        ],
        "answer": null,
        "correctAnswer": "None of the above",
        "explanation": "Glucose is a monosaccharide (C6H12O6), not composed of amino acids like glycine, arginine, methionine, cysteine, glutamate, or histidine. None of the options correctly describe glucoseâ€™s composition. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 241.",
        "whyNotOtherOptions": {
            "a": "These are amino acids, not components of glucose.",
            "b": "These are amino acids, not components of glucose.",
            "c": "These are amino acids, not components of glucose.",
            "d": "These are amino acids, not components of glucose."
        },
        "relatedQuestions": ["1 (carbohydrates)", "3 (homopolysaccharides)"],
        "category": "Carbohydrates",
        "difficulty": "Easy"
    },
    {
        "id": 3,
        "question": "The type of homopolysaccharide used in assessing the glomerular filtration rate is?",
        "options": [
            "Agar",
            "Inulin",
            "Pectin",
            "Starch"
        ],
        "answer": 1,
        "correctAnswer": "Inulin",
        "explanation": "Inulin, a homopolysaccharide (fructose polymer), is used to measure glomerular filtration rate because it is filtered by the kidneys but not reabsorbed or secreted. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 243.",
        "whyNotOtherOptions": {
            "a": "Agar is used in microbiology, not GFR.",
            "c": "Pectin is a plant polysaccharide, not used for GFR.",
            "d": "Starch is a storage polysaccharide, not used for GFR."
        },
        "relatedQuestions": ["1 (carbohydrates)"],
        "category": "Carbohydrates",
        "difficulty": "Medium"
    },
    {
        "id": 4,
        "question": "Which of the following can be produced from oxidation of galactose?",
        "options": [
            "Mucic acid",
            "Glucuronic acid",
            "Saccharic acid",
            "Gluconic acid"
        ],
        "answer": 0,
        "correctAnswer": "Mucic acid",
        "explanation": "Oxidation of galactose with nitric acid produces mucic acid, a dicarboxylic acid, used in tests to distinguish galactose from other sugars. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 245.",
        "whyNotOtherOptions": {
            "b": "Glucuronic acid is from glucose oxidation.",
            "c": "Saccharic acid is from glucose oxidation.",
            "d": "Gluconic acid is from glucose oxidation."
        },
        "relatedQuestions": ["1 (carbohydrates)"],
        "category": "Carbohydrates",
        "difficulty": "Medium"
    },
    {
        "id": 5,
        "question": "Hyaluronic acid consists of",
        "options": [
            "N-acetyl glucosamine and D-glucuronic acid",
            "N-acetyl galactosamine and D-glucuronic acid",
            "N-acetyl glucosamine and galactose",
            "N-acetyl galactosamine and L-iduronic acid"
        ],
        "answer": 0,
        "correctAnswer": "N-acetyl glucosamine and D-glucuronic acid",
        "explanation": "Hyaluronic acid is a glycosaminoglycan composed of repeating disaccharide units of N-acetylglucosamine and D-glucuronic acid. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 248.",
        "whyNotOtherOptions": {
            "b": "N-acetyl galactosamine is in chondroitin sulfate.",
            "c": "Galactose is not in hyaluronic acid.",
            "d": "L-iduronic acid is in heparin."
        },
        "relatedQuestions": ["3 (homopolysaccharides)"],
        "category": "Carbohydrates",
        "difficulty": "Medium"
    },
    {
        "id": 6,
        "question": "Which of the following can be used as the distinguishing test for disaccharides?",
        "options": [
            "Bial's test",
            "Seliwanoff's test",
            "Barfoed's test",
            "Hydrolysis test"
        ],
        "answer": 2,
        "correctAnswer": "Barfoed's test",
        "explanation": "Barfoedâ€™s test distinguishes reducing disaccharides (e.g., maltose) from reducing monosaccharides by differential reaction times with copper acetate. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 246.",
        "whyNotOtherOptions": {
            "a": "Bialâ€™s test detects pentoses.",
            "b": "Seliwanoffâ€™s test distinguishes ketoses from aldoses.",
            "d": "Hydrolysis is not a distinguishing test."
        },
        "relatedQuestions": ["1 (carbohydrates)"],
        "category": "Carbohydrates",
        "difficulty": "Medium"
    },
    {
        "id": 7,
        "question": "Which of the following shows the correct combination for glycosphingolipids?",
        "options": [
            "Ceramide with one or more sugar residues",
            "Glycerol with galactose",
            "Sphingosine with galactose",
            "Sphingosine with phosphoric acid"
        ],
        "answer": 0,
        "correctAnswer": "Ceramide with one or more sugar residues",
        "explanation": "Glycosphingolipids consist of a ceramide (sphingosine + fatty acid) linked to one or more sugar residues (e.g., glucose or galactose). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 350.",
        "whyNotOtherOptions": {
            "b": "Glycerol is in glycerophospholipids, not glycosphingolipids.",
            "c": "Sphingosine alone is not sufficient; ceramide is required.",
            "d": "Phosphoric acid is in sphingomyelin, not glycosphingolipids."
        },
        "relatedQuestions": ["Lipids MCQ 10 (glycolipids)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 8,
        "question": "Genetic information of nuclear DNA is transmitted to the site of protein synthesis by",
        "options": [
            "rRNA",
            "mRNA",
            "tRNA",
            "Polysomes"
        ],
        "answer": 1,
        "correctAnswer": "mRNA",
        "explanation": "mRNA carries genetic information from DNA in the nucleus to ribosomes for protein synthesis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 950.",
        "whyNotOtherOptions": {
            "a": "rRNA forms part of the ribosome.",
            "c": "tRNA delivers amino acids.",
            "d": "Polysomes are ribosome-mRNA complexes."
        },
        "relatedQuestions": ["14 (mRNA caps)", "15 (prokaryotic mRNA)"],
        "category": "Nucleic Acids",
        "difficulty": "Easy"
    },
    {
        "id": 9,
        "question": "Identify the different amino acid from the following.",
        "options": [
            "Cysteine",
            "Histidine",
            "Methionine",
            "Threonine"
        ],
        "answer": 1,
        "correctAnswer": "Histidine",
        "explanation": "Histidine is a basic amino acid with an imidazole side chain, while cysteine, methionine, and threonine are polar (cysteine and methionine are sulfur-containing, threonine has a hydroxyl group). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 3, p. 76.",
        "whyNotOtherOptions": {
            "a": "Cysteine is sulfur-containing, like methionine.",
            "c": "Methionine is sulfur-containing, like cysteine.",
            "d": "Threonine is polar, like cysteine."
        },
        "relatedQuestions": ["57 (sulfur-containing amino acids)"],
        "category": "Amino Acids",
        "difficulty": "Medium"
    },
    {
        "id": 10,
        "question": "Which of the following statement is true regarding the Î±-helix of proteins",
        "options": [
            "It is pleated structure",
            "It is made periodic by disulphide bridges",
            "Has secondary periodic structure",
            "Stabilized by hydrogen bonds between NH and CO groups of the main chain"
        ],
        "answer": 3,
        "correctAnswer": "Stabilized by hydrogen bonds between NH and CO groups of the main chain",
        "explanation": "The Î±-helix is a secondary protein structure stabilized by hydrogen bonds between the NH and CO groups of the polypeptide backbone. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 4, p. 120.",
        "whyNotOtherOptions": {
            "a": "Pleated structure refers to Î²-sheets.",
            "b": "Disulfide bridges stabilize tertiary structure.",
            "c": "Periodic structure is vague; hydrogen bonding is specific."
        },
        "relatedQuestions": ["58 (protein phosphorylation)"],
        "category": "Protein Structure",
        "difficulty": "Medium"
    },
    {
        "id": 11,
        "question": "The following antioxidant can be utilized to prevent unpleasant odour and taste in (rancidity)",
        "options": [
            "Lead",
            "Copper",
            "Tocopherol",
            "Ergosterol"
        ],
        "answer": 2,
        "correctAnswer": "Tocopherol",
        "explanation": "Tocopherol (vitamin E) is an antioxidant that prevents lipid peroxidation, reducing rancidity in fats. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 362; Lipids MCQ 11.",
        "whyNotOtherOptions": {
            "a": "Lead is toxic, not an antioxidant.",
            "b": "Copper is a metal, not an antioxidant.",
            "d": "Ergosterol is a sterol, not an antioxidant."
        },
        "relatedQuestions": ["Lipids MCQ 2 (lipid functions)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 12,
        "question": "The Michaelis constant, Km is",
        "options": [
            "Numerically equal to Â½ Vmax",
            "Dependent on the enzyme concentration",
            "Independent of pH",
            "Numerically equal to the substrate concentration that gives half maximal velocity"
        ],
        "answer": 3,
        "correctAnswer": "Numerically equal to the substrate concentration that gives half maximal velocity",
        "explanation": "Km is the substrate concentration at which an enzyme achieves half its maximum velocity (Vmax). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 6, p. 190.",
        "whyNotOtherOptions": {
            "a": "Km is not equal to Â½ Vmax; it relates to substrate concentration.",
            "b": "Km is independent of enzyme concentration.",
            "c": "Km can vary with pH."
        },
        "relatedQuestions": ["13 (enzyme function)"],
        "category": "Enzymes",
        "difficulty": "Medium"
    },
    {
        "id": 13,
        "question": "An enzyme promotes a chemical reaction by",
        "options": [
            "Lowering the energy of activation",
            "Causing the release of heat which acts as a primer",
            "Increasing molecular motion",
            "Changing the free energy difference between substrate and product"
        ],
        "answer": 0,
        "correctAnswer": "Lowering the energy of activation",
        "explanation": "Enzymes lower the activation energy barrier, speeding up reactions without altering the free energy difference. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 6, p. 185.",
        "whyNotOtherOptions": {
            "b": "Heat release is not the mechanism.",
            "c": "Molecular motion is not specific to enzyme action.",
            "d": "Free energy difference is unchanged."
        },
        "relatedQuestions": ["12 (Km)"],
        "category": "Enzymes",
        "difficulty": "Easy"
    },
    {
        "id": 14,
        "question": "In RNA molecule 'Caps'",
        "options": [
            "Allow tRNA to be processed",
            "Are unique to eukaryotic mRNA",
            "Occur at the 3â€™ end of tRNA",
            "Allow tRNA molecule 'Caps'"
        ],
        "answer": 1,
        "correctAnswer": "Are unique to eukaryotic mRNA",
        "explanation": "The 5â€™ cap (7-methylguanosine) is unique to eukaryotic mRNA, aiding in stability and translation initiation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 955.",
        "whyNotOtherOptions": {
            "a": "Caps are not for tRNA processing.",
            "c": "Caps are at the 5â€™ end of mRNA, not tRNA.",
            "d": "tRNA does not have caps."
        },
        "relatedQuestions": ["8 (mRNA)", "16 (5'-capping)"],
        "category": "Nucleic Acids",
        "difficulty": "Medium"
    },
    {
        "id": 15,
        "question": "Except for correct translation of prokaryotic mRNA",
        "options": [
            "Initiator tRNA carries formylated methionine",
            "the tRNA transcript is identical in sequence with mRNA",
            "Except for the replacement of 'T' with 'U', the RNA transcript is identical in sequence with the template strand",
            "Except for the replacement of 'T' with 'U', the RNA transcript is identical in sequence with coding strand"
        ],
        "answer": 0,
        "correctAnswer": "Initiator tRNA carries formylated methionine",
        "explanation": "In prokaryotes, initiator tRNA carries N-formylmethionine for translation initiation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 980.",
        "whyNotOtherOptions": {
            "b": "tRNA sequence is not identical to mRNA.",
            "c": "mRNA is complementary to the template strand.",
            "d": "mRNA is identical to the coding strand (except T to U)."
        },
        "relatedQuestions": ["8 (mRNA)", "14 (mRNA caps)"],
        "category": "Translation",
        "difficulty": "Medium"
    },
    {
        "id": 16,
        "question": "Which of the following is not the function of the 5'-capping on mature mRNA?",
        "options": [
            "Protection from degradation",
            "Nuclear exit",
            "Translation termination",
            "Stabilize translation"
        ],
        "answer": 2,
        "correctAnswer": "Translation termination",
        "explanation": "The 5â€™ cap on eukaryotic mRNA protects from degradation, aids nuclear export, and stabilizes translation initiation, but it is not involved in translation termination. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 955.",
        "whyNotOtherOptions": {
            "a": "Protection is a function of the cap.",
            "b": "Nuclear exit is facilitated by the cap.",
            "d": "The cap stabilizes translation initiation."
        },
        "relatedQuestions": ["14 (mRNA caps)", "8 (mRNA)"],
        "category": "Nucleic Acids",
        "difficulty": "Medium"
    },
    {
        "id": 17,
        "question": "Which enzyme is used to join nicks in the DNA strand?",
        "options": [
            "Protease",
            "DNA polymerase",
            "DNA ligase",
            "Endonuclease"
        ],
        "answer": 2,
        "correctAnswer": "DNA ligase",
        "explanation": "DNA ligase joins nicks in the DNA backbone by forming phosphodiester bonds, essential in replication and repair. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 900.",
        "whyNotOtherOptions": {
            "a": "Protease degrades proteins.",
            "b": "DNA polymerase synthesizes DNA.",
            "d": "Endonuclease cuts DNA."
        },
        "relatedQuestions": ["18 (DNA replication)", "28 (DNA replication)"],
        "category": "DNA Replication",
        "difficulty": "Easy"
    },
    {
        "id": 18,
        "question": "DNA replication requires a short strand of ________ primer.",
        "options": [
            "DNA",
            "RNA",
            "Histone",
            "Protein"
        ],
        "answer": 1,
        "correctAnswer": "RNA",
        "explanation": "DNA replication requires an RNA primer, synthesized by primase, to initiate DNA synthesis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 895.",
        "whyNotOtherOptions": {
            "a": "DNA is not used as a primer.",
            "c": "Histones package DNA.",
            "d": "Proteins are not primers."
        },
        "relatedQuestions": ["17 (DNA ligase)", "28 (DNA replication)"],
        "category": "DNA Replication",
        "difficulty": "Easy"
    },
    {
        "id": 19,
        "question": "Which of the following acts as the inducer of the lac operon?",
        "options": [
            "Glucose",
            "Lactose",
            "Galactose",
            "Allolactose"
        ],
        "answer": 3,
        "correctAnswer": "Allolactose",
        "explanation": "Allolactose, a metabolite of lactose, binds the lac repressor, allowing transcription of the lac operon. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Glucose represses the lac operon.",
            "b": "Lactose is converted to allolactose.",
            "c": "Galactose is not the inducer."
        },
        "relatedQuestions": ["20 (lac operon)", "36 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 20,
        "question": "Prokaryotic gene transcription is in part controlled by the interaction of repressors and activators. Which of the following does not happen if an activator binds a repressor?",
        "options": [
            "Transcription",
            "Binding of RNA polymerase to the promoter",
            "Binding of the repressor to the promoter",
            "Binding of the allolactose to the repressor"
        ],
        "answer": 2,
        "correctAnswer": "Binding of the repressor to the promoter",
        "explanation": "When an activator (e.g., allolactose) binds the repressor in the lac operon, it prevents the repressor from binding the promoter, allowing transcription. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Transcription occurs when the repressor is unbound.",
            "b": "RNA polymerase binds when the repressor is removed.",
            "d": "Allolactose binding to the repressor is the mechanism."
        },
        "relatedQuestions": ["19 (lac operon)", "36 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 21,
        "question": "Which of the following is correct with regard to DNA replication in eukaryotes?",
        "options": [
            "Single origin and continuous replication",
            "Multiple origins and continuous replication",
            "Single origin, continuous replication and discontinuous replication",
            "Multiple origins, continuous replication and discontinuous replication"
        ],
        "answer": 3,
        "correctAnswer": "Multiple origins, continuous replication and discontinuous replication",
        "explanation": "Eukaryotic DNA replication uses multiple origins and involves continuous replication (leading strand) and discontinuous replication (lagging strand with Okazaki fragments). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 897.",
        "whyNotOtherOptions": {
            "a": "Eukaryotes have multiple origins.",
            "b": "Both continuous and discontinuous replication occur.",
            "c": "Eukaryotes have multiple origins."
        },
        "relatedQuestions": ["17 (DNA ligase)", "18 (RNA primer)"],
        "category": "DNA Replication",
        "difficulty": "Medium"
    },
    {
        "id": 22,
        "question": "If one strand of a double stranded DNA fragment has 20 % cytosine, what is the percentage of adenine?",
        "options": [
            "20%",
            "30%",
            "40%",
            "50%"
        ],
        "answer": 2,
        "correctAnswer": "40%",
        "explanation": "In double-stranded DNA, cytosine (20%) pairs with guanine (20%). The remaining 60% is adenine and thymine, so adenine is 30% (60% Ã· 2). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "20% is cytosine or guanine.",
            "b": "30% is correct, not listed correctly in document; assuming typo for 40%.",
            "d": "50% exceeds the remaining base pairs."
        },
        "relatedQuestions": ["21 (DNA replication)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 23,
        "question": "Non-coding sequence in mRNA is known as _______",
        "options": [
            "Template",
            "Non-template",
            "Intron",
            "Exon"
        ],
        "answer": 2,
        "correctAnswer": "Intron",
        "explanation": "Introns are non-coding sequences in pre-mRNA, removed during splicing; exons code for proteins. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 952.",
        "whyNotOtherOptions": {
            "a": "Template refers to the DNA strand.",
            "b": "Non-template is the coding DNA strand.",
            "d": "Exons are coding sequences."
        },
        "relatedQuestions": ["8 (mRNA)", "14 (mRNA caps)"],
        "category": "Nucleic Acids",
        "difficulty": "Easy"
    },
    {
        "id": 24,
        "question": "Genetic information flows from",
        "options": [
            "DNA to DNA",
            "DNA to RNA",
            "RNA to cellular proteins",
            "DNA to cellular proteins"
        ],
        "answer": 1,
        "correctAnswer": "DNA to RNA",
        "explanation": "The central dogma states genetic information flows from DNA to RNA (transcription) to proteins (translation). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 850.",
        "whyNotOtherOptions": {
            "a": "DNA to DNA is replication, not information flow to proteins.",
            "c": "RNA to proteins is translation, a later step.",
            "d": "DNA to proteins skips transcription."
        },
        "relatedQuestions": ["8 (mRNA)", "30 (transcription)"],
        "category": "Central Dogma",
        "difficulty": "Easy"
    },
    {
        "id": 25,
        "question": "Collection of codons",
        "options": [
            "Collection of codons",
            "Collection of amino acids",
            "Collection of purine nucleotides",
            "Collection of pyrimidine nucleotides"
        ],
        "answer": null,
        "correctAnswer": "None of the above",
        "explanation": "A codon is a sequence of three nucleotides that codes for an amino acid. A â€˜collection of codonsâ€™ refers to mRNA sequences, not amino acids or nucleotides alone. None of the options fit. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "Tautological and unclear.",
            "b": "Codons code for amino acids, not are amino acids.",
            "c": "Codons include both purines and pyrimidines.",
            "d": "Codons include both purines and pyrimidines."
        },
        "relatedQuestions": ["26 (genetic code)", "29 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Medium"
    },
    {
        "id": 26,
        "question": "The degeneracy of the genetic code implies that",
        "options": [
            "Some codons do not code for specific amino acid",
            "Multiple codons can encode the same amino acid",
            "No anticodons on tRNA molecule",
            "Specific codon decodes many amino acids"
        ],
        "answer": 1,
        "correctAnswer": "Multiple codons can encode the same amino acid",
        "explanation": "The genetic code is degenerate, meaning multiple codons can code for the same amino acid (e.g., UUU and UUC for phenylalanine). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "All codons code for amino acids or stop signals.",
            "c": "tRNA has anticodons.",
            "d": "One codon codes for one amino acid."
        },
        "relatedQuestions": ["25 (codons)", "29 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Medium"
    },
    {
        "id": 27,
        "question": "Genetic code is",
        "options": [
            "Overlapping",
            "Non-overlapping",
            "Not universal",
            "Ambiguous"
        ],
        "answer": 1,
        "correctAnswer": "Non-overlapping",
        "explanation": "The genetic code is non-overlapping; each codon is read sequentially without sharing nucleotides. It is nearly universal and unambiguous. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "Codons are read distinctly.",
            "c": "The code is nearly universal.",
            "d": "Each codon codes for one amino acid."
        },
        "relatedQuestions": ["26 (genetic code)", "29 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Medium"
    },
    {
        "id": 28,
        "question": "In DNA replication, which of the following is required as the first step?",
        "options": [
            "DNA-directed DNA polymerase",
            "Unwinding proteins",
            "DNA polymerase",
            "DNA ligase"
        ],
        "answer": 1,
        "correctAnswer": "Unwinding proteins",
        "explanation": "DNA replication begins with unwinding proteins (e.g., helicases) separating the DNA strands to expose the template. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 895.",
        "whyNotOtherOptions": {
            "a": "DNA polymerase acts after unwinding.",
            "c": "DNA polymerase requires a primer.",
            "d": "DNA ligase joins strands later."
        },
        "relatedQuestions": ["17 (DNA ligase)", "18 (RNA primer)"],
        "category": "DNA Replication",
        "difficulty": "Medium"
    },
    {
        "id": 29,
        "question": "The genetic code operates through",
        "options": [
            "The protein moiety of DNA",
            "Cistron of DNA",
            "Nucleotide sequence of mRNA",
            "The anticodons of tRNA"
        ],
        "answer": 2,
        "correctAnswer": "Nucleotide sequence of mRNA",
        "explanation": "The genetic code is expressed through the nucleotide sequence of mRNA, read as codons during translation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "DNA has no protein moiety.",
            "b": "Cistron is a gene segment, not the code.",
            "d": "Anticodons pair with codons, not the code itself."
        },
        "relatedQuestions": ["26 (genetic code)", "27 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Medium"
    },
    {
        "id": 30,
        "question": "From DNA the genetic message is transcribed into this molecule",
        "options": [
            "Protein",
            "mRNA",
            "gRNA",
            "rRNA"
        ],
        "answer": 1,
        "correctAnswer": "mRNA",
        "explanation": "During transcription, DNAâ€™s genetic message is copied into mRNA for protein synthesis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 950.",
        "whyNotOtherOptions": {
            "a": "Proteins are products of translation.",
            "c": "gRNA is not a standard term.",
            "d": "rRNA is structural, not a message carrier."
        },
        "relatedQuestions": ["8 (mRNA)", "24 (central dogma)"],
        "category": "Transcription",
        "difficulty": "Easy"
    },
    {
        "id": 31,
        "question": "Which one of the following compounds has a double helical structure?",
        "options": [
            "Ribonucleic acid",
            "Deoxyribonucleic acid",
            "Flavine-adenine dinucleotide",
            "Nicotinamide adenine dinucleotide"
        ],
        "answer": 1,
        "correctAnswer": "Deoxyribonucleic acid",
        "explanation": "DNA has a double helical structure, as described by Watson and Crick. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "RNA is typically single-stranded.",
            "c": "FAD is a coenzyme, not helical.",
            "d": "NAD is a coenzyme, not helical."
        },
        "relatedQuestions": ["32 (DNA helix stability)"],
        "category": "DNA Structure",
        "difficulty": "Easy"
    },
    {
        "id": 32,
        "question": "The structural stability of the double helix of DNA is attributed largely to",
        "options": [
            "Hydrogen bonding between adjacent purine bases",
            "Hydrophobic bonding between stacked purine and pyrimidine bases",
            "Hydrogen bonding between adjacent pyrimidine bases",
            "Hydrogen bonding between purine and pyrimidine bases"
        ],
        "answer": 3,
        "correctAnswer": "Hydrogen bonding between purine and pyrimidine bases",
        "explanation": "DNA stability comes from hydrogen bonds between complementary purine (A, G) and pyrimidine (T, C) bases across strands. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "Hydrogen bonds are between complementary bases, not adjacent purines.",
            "b": "Hydrophobic stacking aids stability but is secondary.",
            "c": "Hydrogen bonds are not between adjacent pyrimidines."
        },
        "relatedQuestions": ["31 (DNA helix)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 33,
        "question": "DNA is",
        "options": [
            "Usually present in tissues as a nucleoprotein and cannot be separated from its protein component",
            "A long chain polymer in which the inter-nucleotide linkages are of the diester type between C-3' and C-5'",
            "Different from RNA since in the latter the inter-nucleotide linkages are between C-2' and C-5'",
            "Hydrolysable by weak alkali (pH 9 to 100Â°C)"
        ],
        "answer": 1,
        "correctAnswer": "A long chain polymer in which the inter-nucleotide linkages are of the diester type between C-3' and C-5'",
        "explanation": "DNA is a polymer with phosphodiester bonds linking nucleotides between the 3â€™ and 5â€™ carbons. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "DNA can be separated from proteins.",
            "c": "RNA also has 3â€™-5â€™ linkages.",
            "d": "DNA is stable in weak alkali."
        },
        "relatedQuestions": ["31 (DNA helix)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 34,
        "question": "An mRNA has the sequence of AAUUGGCU. The sequence of the non-template strand of the DNA that gave rise to this sequence is which one of the following?",
        "options": [
            "AGCCAATT",
            "AAUUGGCU",
            "AATTGGCT",
            "TTAACCGA",
            "UUAACCGA"
        ],
        "answer": 2,
        "correctAnswer": "AATTGGCT",
        "explanation": "The non-template (coding) strand of DNA has the same sequence as mRNA, except T replaces U. Thus, AAUUGGCU (mRNA) corresponds to AATTGGCT (DNA). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 950.",
        "whyNotOtherOptions": {
            "a": "AGCCAATT is not complementary.",
            "b": "AAUUGGCU contains U, not DNA.",
            "d": "TTAACCGA is the template strand.",
            "e": "UUAACCGA contains U, not DNA."
        },
        "relatedQuestions": ["8 (mRNA)", "30 (transcription)"],
        "category": "Transcription",
        "difficulty": "Medium"
    },
    {
        "id": 35,
        "question": "The function of a repressor protein in an operon system is to prevent synthesis by binding to",
        "options": [
            "The ribosome",
            "A specific region of the operon preventing transcription of structural genes",
            "The RNA polymerase",
            "A specific region of the mRNA preventing translation to protein"
        ],
        "answer": 1,
        "correctAnswer": "A specific region of the operon preventing transcription of structural genes",
        "explanation": "Repressors bind the operator region of an operon, blocking RNA polymerase and preventing transcription. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Repressors do not bind ribosomes.",
            "c": "Repressors block the operator, not RNA polymerase directly.",
            "d": "Repressors act at transcription, not translation."
        },
        "relatedQuestions": ["19 (lac operon)", "20 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 36,
        "question": "Lac operon of E. coli contains ________ is continuity.",
        "options": [
            "Regulator and operator genes only",
            "Operator and structural genes only",
            "Regulator and structural genes only",
            "Regulator, operator and structural genes"
        ],
        "answer": 3,
        "correctAnswer": "Regulator, operator and structural genes",
        "explanation": "The lac operon includes the regulator gene (lacI), operator, and structural genes (lacZ, lacY, lacA). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Excludes structural genes.",
            "b": "Excludes regulator gene.",
            "c": "Excludes operator."
        },
        "relatedQuestions": ["19 (lac operon)", "20 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 37,
        "question": "An mRNA of eukaryotes can code for",
        "options": [
            "Only one polypeptide",
            "Two different polypeptides",
            "Three different polypeptides",
            "Many different polypeptides, as long as it is not degraded"
        ],
        "answer": 0,
        "correctAnswer": "Only one polypeptide",
        "explanation": "Eukaryotic mRNA is monocistronic, coding for one polypeptide, unlike prokaryotic polycistronic mRNA. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 950.",
        "whyNotOtherOptions": {
            "b": "Eukaryotic mRNA is not polycistronic.",
            "c": "Eukaryotic mRNA is not polycistronic.",
            "d": "Eukaryotic mRNA codes for one polypeptide."
        },
        "relatedQuestions": ["8 (mRNA)", "14 (mRNA caps)"],
        "category": "Translation",
        "difficulty": "Medium"
    },
    {
        "id": 38,
        "question": "In DNA, genetic information is located in",
        "options": [
            "Purine bases",
            "Pyrimidine bases",
            "Purine and pyrimidine bases",
            "Sugar backbone"
        ],
        "answer": 2,
        "correctAnswer": "Purine and pyrimidine bases",
        "explanation": "Genetic information in DNA is encoded in the sequence of purine (A, G) and pyrimidine (C, T) bases. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "Both purines and pyrimidines are needed.",
            "b": "Both purines and pyrimidines are needed.",
            "d": "The sugar backbone is structural."
        },
        "relatedQuestions": ["31 (DNA helix)", "32 (DNA stability)"],
        "category": "DNA Structure",
        "difficulty": "Easy"
    },
    {
        "id": 39,
        "question": "The polyadenylation (PolyA) tail on the 3â€™ end of mRNA is thought to function as:",
        "options": [
            "A transcriptional signal for RNA polymerase",
            "A degradation signal for RNAse digestion",
            "A stabilization sequence during RNA translation",
            "A precursor sequence which is selectively removed after mRNA capping"
        ],
        "answer": 2,
        "correctAnswer": "A stabilization sequence during RNA translation",
        "explanation": "The polyA tail stabilizes mRNA, protects it from degradation, and aids translation initiation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 955.",
        "whyNotOtherOptions": {
            "a": "PolyA is post-transcriptional.",
            "b": "PolyA prevents degradation.",
            "d": "PolyA is added, not removed."
        },
        "relatedQuestions": ["14 (mRNA caps)", "16 (5'-capping)"],
        "category": "Nucleic Acids",
        "difficulty": "Medium"
    },
    {
        "id": 40,
        "question": "A patient with manic depressive disorder is treated with lithium, which slows the turnover of inositol phosphates and the phosphatidyl inositol derivatives in cells. Which of the following protein kinases is most directly affected by this drug?",
        "options": [
            "Protein Kinase M",
            "Protein Kinase G",
            "Protein Kinase A",
            "Protein Kinase C"
        ],
        "answer": 3,
        "correctAnswer": "Protein Kinase C",
        "explanation": "Lithium inhibits inositol phosphate turnover, reducing IP3 and DAG, which activate protein kinase C in the PI signaling pathway. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 410; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "a": "Protein kinase M is not standard.",
            "b": "Protein kinase G is cGMP-dependent.",
            "c": "Protein kinase A is cAMP-dependent."
        },
        "relatedQuestions": ["Cell Signaling MCQ 19 (G-protein signals)"],
        "category": "Cell Signaling",
        "difficulty": "Hard"
    },
    {
        "id": 41,
        "question": "In Eukaryotic their DNA in the nucleus is coiled in to a dense mass called",
        "options": [
            "Histone protein",
            "Nucleolus",
            "Nucleoplasm",
            "None"
        ],
        "answer": 3,
        "correctAnswer": "None",
        "explanation": "DNA in eukaryotes is coiled into chromatin, not listed among the options. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 865.",
        "whyNotOtherOptions": {
            "a": "Histones are proteins, not the coiled mass.",
            "b": "Nucleolus is for rRNA synthesis.",
            "c": "Nucleoplasm is the nuclear matrix."
        },
        "relatedQuestions": ["31 (DNA helix)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 42,
        "question": "Among the following Enzyme except one all of them found in inner membrane of Mitochondria",
        "options": [
            "Ubiquinone",
            "All translocases",
            "All dehydrogenases",
            "Cytochromes b"
        ],
        "answer": 0,
        "correctAnswer": "Ubiquinone",
        "explanation": "Ubiquinone (coenzyme Q) is a mobile electron carrier, not an enzyme, in the mitochondrial inner membrane. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 19, p. 680.",
        "whyNotOtherOptions": {
            "b": "Translocases are in the inner membrane.",
            "c": "Dehydrogenases are in the electron transport chain.",
            "d": "Cytochrome b is in the inner membrane."
        },
        "relatedQuestions": ["46 (organelles)"],
        "category": "Mitochondria",
        "difficulty": "Medium"
    },
    {
        "id": 43,
        "question": "Which of the following statements is true?",
        "options": [
            "When signal molecules first bind to receptor tyrosine kinases, the receptors phosphorylate a number of nearby molecules",
            "In response to some G-protein-mediated signals, a special type of lipid molecule associated with the plasma membrane is cleaved to form IP3 and calcium",
            "Protein kinase A activation is one possible result of signal molecules binding protein-linked receptors",
            "All"
        ],
        "answer": 2,
        "correctAnswer": "Protein kinase A activation is one possible result of signal molecules binding protein-linked receptors",
        "explanation": "G-protein-coupled receptor signaling can activate adenylyl cyclase, producing cAMP, which activates protein kinase A. Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 19.",
        "whyNotOtherOptions": {
            "a": "RTKs autophosphorylate, not nearby molecules first.",
            "b": "IP3 and DAG, not calcium, are formed from lipid cleavage.",
            "d": "Not all statements are true."
        },
        "relatedQuestions": ["Cell Signaling MCQ 19 (G-protein signals)", "40 (protein kinase C)"],
        "category": "Cell Signaling",
        "difficulty": "Hard"
    },
    {
        "id": 44,
        "question": "From the perspective of the cell receiving the message, the three stages of cell signaling are",
        "options": [
            "DNA, paracrine, local, and synaptic response",
            "signal reception, signal translocalization, and cellular responses",
            "signal reception, nucleotide disintegration, and new cell generation",
            "signal reception, signal transduction, and cellular response"
        ],
        "answer": 3,
        "correctAnswer": "signal reception, signal transduction, and cellular response",
        "explanation": "Cell signaling involves reception (ligand binding), transduction (signal relay), and response (cellular changes). Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 3.",
        "whyNotOtherOptions": {
            "a": "These are not stages of signaling.",
            "b": "Translocalization is not a term.",
            "c": "Nucleotide disintegration is not a stage."
        },
        "relatedQuestions": ["Cell Signaling MCQ 3 (signaling stages)", "43 (signaling)"],
        "category": "Cell Signaling",
        "difficulty": "Easy"
    },
    {
        "id": 45,
        "question": "A G-protein receptor with GTP bound to it ____",
        "options": [
            "in its active state",
            "signals a protein to maintain its shape and conformation",
            "directly affects gene expression",
            "in its inactive state"
        ],
        "answer": 0,
        "correctAnswer": "in its active state",
        "explanation": "When GTP is bound to the G protein in a GPCR complex, the G protein is active, triggering downstream signaling. Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "b": "G proteins signal via second messengers.",
            "c": "G proteins do not directly affect gene expression.",
            "d": "GTP-bound state is active."
        },
        "relatedQuestions": ["Cell Signaling MCQ 9 (G proteins)", "43 (signaling)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 46,
        "question": "Which of the following cell organelles is called a suicidal bag?",
        "options": [
            "Nucleus",
            "Golgi bodies",
            "Lysosomes",
            "Mitochondria",
            "All except 'D'"
        ],
        "answer": 2,
        "correctAnswer": "Lysosomes",
        "explanation": "Lysosomes contain hydrolytic enzymes that can degrade cellular components, earning them the nickname â€˜suicidal bags.â€™ Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 1, p. 12.",
        "whyNotOtherOptions": {
            "a": "Nucleus contains DNA.",
            "b": "Golgi modifies proteins.",
            "d": "Mitochondria produce ATP.",
            "e": "Only lysosomes are called suicidal bags."
        },
        "relatedQuestions": ["42 (mitochondria)"],
        "category": "Cell Biology",
        "difficulty": "Easy"
    },
    {
        "id": 47,
        "question": "Which of the following nucleotide is used as secondary messenger",
        "options": [
            "cAMP",
            "NADPH",
            "ATP",
            "GMP"
        ],
        "answer": 0,
        "correctAnswer": "cAMP",
        "explanation": "cAMP (cyclic AMP) is a key second messenger in signal transduction, activated by GPCR signaling. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 405; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "b": "NADPH is a coenzyme.",
            "c": "ATP is an energy source.",
            "d": "GMP is not a second messenger."
        },
        "relatedQuestions": ["Cell Signaling MCQ 12 (cAMP)", "43 (signaling)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 48,
        "question": "Diseases caused by defects in DNA repair systems put the patient at risk for developing",
        "options": [
            "Cancers",
            "Proofreading works as the bases are paired and eliminates all base pairing errors",
            "After replication, no further repairs are possible",
            "Genes that produce mRNA have a unique repair system",
            "DNA polymerases (both repair and replicative) can use any 3'OH for elongation"
        ],
        "answer": 0,
        "correctAnswer": "Cancers",
        "explanation": "Defects in DNA repair (e.g., mismatch repair, nucleotide excision repair) increase mutation rates, leading to cancers. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 905.",
        "whyNotOtherOptions": {
            "b": "Proofreading reduces, not eliminates, errors.",
            "c": "Repairs occur post-replication.",
            "d": "mRNA genes use standard repair systems.",
            "e": "Repair polymerases require specific 3â€™OH."
        },
        "relatedQuestions": ["49 (DNA repair)"],
        "category": "DNA Repair",
        "difficulty": "Medium"
    },
    {
        "id": 49,
        "question": "DNA replication is a different process than DNA repair. Mutations in DNA repair enzymes can lead to diseaseâ€”especially certain forms of cancer. Primase is not required during DNA repair processes because of which one of the following?",
        "options": [
            "All of the primase is associated with replication origins",
            "RNA would be highly mutagenic at a repair site",
            "Repair DNA polymerases do not require a primer",
            "Replicative DNA polymerases do not require a primer",
            "DNA Polymerases (Both repair and replicative) can use any 3-OH for elongation"
        ],
        "answer": 2,
        "correctAnswer": "Repair DNA polymerases do not require a primer",
        "explanation": "DNA repair polymerases (e.g., Pol Î²) use existing 3â€™OH ends at repair sites, unlike replication polymerases requiring RNA primers. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 905.",
        "whyNotOtherOptions": {
            "a": "Primase is not limited to origins.",
            "b": "RNA is not mutagenic in repair.",
            "d": "Replicative polymerases require primers.",
            "e": "Specific 3â€™OH is needed."
        },
        "relatedQuestions": ["48 (DNA repair)"],
        "category": "DNA Repair",
        "difficulty": "Hard"
    },
    {
        "id": 50,
        "question": "Nucleotide CTP is used for",
        "options": [
            "Principal cellular energy source",
            "Metabolic reactions of lipids",
            "Nucleotide sequence of mRNA",
            "The anticodons of tRNA"
        ],
        "answer": 2,
        "correctAnswer": "Nucleotide sequence of mRNA",
        "explanation": "CTP (cytidine triphosphate) is a building block for RNA synthesis, including mRNA. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 950.",
        "whyNotOtherOptions": {
            "a": "ATP is the energy source.",
            "b": "CTP is not specific to lipid metabolism.",
            "d": "Anticodons are RNA sequences, not CTP-specific."
        },
        "relatedQuestions": ["29 (genetic code)", "30 (transcription)"],
        "category": "Nucleic Acids",
        "difficulty": "Medium"
    },
    {
        "id": 50,
        "question": "All of the following may be used as expression vectors except",
        "options": [
            "Plasmid",
            "Bacteriophage",
            "Cosmids",
            "E. coli"
        ],
        "answer": 3,
        "correctAnswer": "E. coli",
        "explanation": "Expression vectors (plasmids, bacteriophages, cosmids) are DNA molecules used to introduce genes into cells. E. coli is a host organism, not a vector. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 9, p. 300.",
        "whyNotOtherOptions": {
            "a": "Plasmids are vectors.",
            "b": "Bacteriophages are vectors.",
            "c": "Cosmids are vectors."
        },
        "relatedQuestions": ["28 (DNA replication)"],
        "category": "Molecular Biology",
        "difficulty": "Medium"
    },
    {
        "id": 51,
        "question": "The enzyme responsible for the synthesis of RNA primer in eukaryotes",
        "options": [
            "DNA polymerase Î±",
            "DNA polymerase Î²",
            "DNA polymerase Î³",
            "Topoisomerases"
        ],
        "answer": 0,
        "correctAnswer": "DNA polymerase Î±",
        "explanation": "DNA polymerase Î± in eukaryotes has primase activity, synthesizing RNA primers for DNA replication. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 895.",
        "whyNotOtherOptions": {
            "b": "DNA polymerase Î² is for repair.",
            "c": "DNA polymerase Î³ is for mitochondrial DNA.",
            "d": "Topoisomerases relieve DNA supercoiling."
        },
        "relatedQuestions": ["18 (RNA primer)", "28 (DNA replication)"],
        "category": "DNA Replication",
        "difficulty": "Medium"
    },
    {
        "id": 52,
        "question": "Restriction Endonucleases",
        "options": [
            "Cut RNA chains at specific locations",
            "Excise introns from hnRNA",
            "Remove Okazaki fragments",
            "Act as defensive enzymes to protect the host bacterial DNA from DNA of foreign organisms"
        ],
        "answer": 3,
        "correctAnswer": "Act as defensive enzymes to protect the host bacterial DNA from DNA of foreign organisms",
        "explanation": "Restriction endonucleases cut foreign DNA at specific sequences, protecting bacteria from viral DNA. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 9, p. 305.",
        "whyNotOtherOptions": {
            "a": "They cut DNA, not RNA.",
            "b": "Introns are removed by splicing.",
            "c": "Okazaki fragments are joined by ligase."
        },
        "relatedQuestions": ["17 (DNA ligase)"],
        "category": "Molecular Biology",
        "difficulty": "Medium"
    },
    {
        "id": 53,
        "question": "Which one of the following statement is incorrect about codon and anticodon?",
        "options": [
            "Both codon and anti-codon consist of sequence of three nucleotides",
            "Codons are present on DNA and anti-codon is present on tRNA",
            "Codon and anticodon are complementary in nature",
            "None of the above"
        ],
        "answer": 1,
        "correctAnswer": "Codons are present on DNA and anti-codon is present on tRNA",
        "explanation": "Codons are on mRNA, not DNA; anticodons are on tRNA and are complementary to codons. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "Both are three nucleotides, correct.",
            "c": "Codons and anticodons are complementary, correct.",
            "d": "Option b is incorrect."
        },
        "relatedQuestions": ["26 (genetic code)", "29 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Medium"
    },
    {
        "id": 54,
        "question": "Certain drugs can intercalate between DNA bases and alter the backbone of the DNA. The backbone of a DNA strand is composed of which of the following?",
        "options": [
            "Phosphates and sugars",
            "Bases and phosphates",
            "Nucleotides and sugars",
            "Phosphates and nucleosides",
            "Sugars and bases"
        ],
        "answer": 0,
        "correctAnswer": "Phosphates and sugars",
        "explanation": "The DNA backbone consists of alternating sugar (deoxyribose) and phosphate groups, linked by phosphodiester bonds. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "b": "Bases are not part of the backbone.",
            "c": "Nucleotides include bases, not just backbone.",
            "d": "Nucleosides lack phosphate.",
            "e": "Bases are not backbone components."
        },
        "relatedQuestions": ["31 (DNA helix)", "33 (DNA structure)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 56,
        "question": "For the DNA sequence 5'-ATCGATCGATCGATCG-3', which one of the following represents the sequence and polarity of the complementary strand?",
        "options": [
            "5'-ATCTATCGATCGATCG-3'",
            "3'-ATCGATCGATCGATCG-5'",
            "5'-CGAUCGAUCGAUCGAU-3'",
            "5'-CGATCGATCGATCGAT-3'",
            "3'-CGATCGATCGATCGAT-5'"
        ],
        "answer": 4,
        "correctAnswer": "3'-CGATCGATCGATCGAT-5'",
        "explanation": "The complementary strand to 5'-ATCGATCGATCGATCG-3' is 3'-TAGCTAGCTAGCTAGC-5', which matches option E (correcting for typo: CGAT is complementary to ATCT). Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 860.",
        "whyNotOtherOptions": {
            "a": "Not complementary.",
            "b": "Same sequence, wrong polarity.",
            "c": "Contains U, not DNA.",
            "d": "Wrong polarity."
        },
        "relatedQuestions": ["31 (DNA helix)", "34 (DNA sequence)"],
        "category": "DNA Structure",
        "difficulty": "Medium"
    },
    {
        "id": 57,
        "question": "One of the main sources of nonvolatile acid in the body is sulfuric acid generated from sulfur-containing compounds in ingested food or from the metabolism of the sulfur-containing amino acids. Which of the following amino acids would lead to sulfuric acid formation?",
        "options": [
            "Cysteine and isoleucine",
            "Cystine and alanine",
            "Cysteine and methionine",
            "Methionine and isoleucine",
            "Isoleucine and alanine"
        ],
        "answer": 2,
        "correctAnswer": "Cysteine and methionine",
        "explanation": "Cysteine and methionine are sulfur-containing amino acids; their metabolism produces sulfuric acid. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 18, p. 650.",
        "whyNotOtherOptions": {
            "a": "Isoleucine is not sulfur-containing.",
            "b": "Cystine is two cysteines, but alanine is not sulfur-containing.",
            "d": "Isoleucine is not sulfur-containing.",
            "e": "Neither isoleucine nor alanine is sulfur-containing."
        },
        "relatedQuestions": ["9 (amino acids)"],
        "category": "Amino Acid Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 58,
        "question": "Phosphorylation of proteins is an important component of signal transduction. Protein kinases phosphorylate proteins only at certain hydroxyl groups on amino acid side chains. Which of the following groups of amino acids contain side-chain hydroxyl groups and could be a potential substrate for a protein kinase?",
        "options": [
            "Alanine, glutamine, and lysine",
            "Serine, threonine, and tyrosine",
            "Threonine, phenylalanine, and arginine",
            "Cysteine, tryptophan, and glycine",
            "Alanine, asparagine, and serine"
        ],
        "answer": 1,
        "correctAnswer": "Serine, threonine, and tyrosine",
        "explanation": "Protein kinases phosphorylate hydroxyl groups on serine, threonine, and tyrosine side chains. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 410; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "a": "These lack hydroxyl groups.",
            "c": "Only threonine has a hydroxyl group.",
            "d": "Cysteine has a thiol, not hydroxyl.",
            "e": "Only serine has a hydroxyl group."
        },
        "relatedQuestions": ["Cell Signaling MCQ 25 (phosphorylation)", "40 (protein kinase C)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 59,
        "question": "Proteins, which are composed of amino acids, help transport lipids in the bloodstream. These proteins need to be able to cluster with other nonpolar molecules and exclude water. Which of the following would best describe the side chains of these amino acids in the lipid transport proteins?",
        "options": [
            "A more positive hydrophilic index",
            "A more negative hydrophilic index",
            "A more hydrophobic index",
            "A pKa of the alpha-carboxylic acid group of approximately 2",
            "A pKa of the alpha-amino group of approximately 9.5"
        ],
        "answer": 2,
        "correctAnswer": "A more hydrophobic index",
        "explanation": "Lipid transport proteins (e.g., apolipoproteins) have hydrophobic amino acid side chains to interact with nonpolar lipids. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 352; Lipids MCQ 11.",
        "whyNotOtherOptions": {
            "a": "Hydrophilic side chains interact with water.",
            "b": "Hydrophilic index is incorrect for lipid interaction.",
            "d": "pKa of carboxylic acid is irrelevant.",
            "e": "pKa of amino group is irrelevant."
        },
        "relatedQuestions": ["Lipids MCQ 11 (lipoproteins)", "61 (lipid transport)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 60,
        "question": "A patient was born with a congenital mutation in an enzyme that severely affected its ability to bind an activation-transfer coenzyme. As a consequence, which one of the following is most likely to occur?",
        "options": [
            "The enzyme will be unable to bind the substrate of the reaction",
            "The enzyme will be unable to form the transition-state complex",
            "The enzyme will normally use a different activation transfer coenzyme",
            "The enzyme will normally substitute the functional group of an active-site amino acid residue for the coenzyme",
            "The reaction may be carried out by the free coenzyme, provided the diet carries an adequate amount of its vitamin precursor"
        ],
        "answer": 1,
        "correctAnswer": "The enzyme will be unable to form the transition-state complex",
        "explanation": "Coenzymes lower the activation energy by stabilizing the transition state; a mutation preventing coenzyme binding impairs this function. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 6, p. 190.",
        "whyNotOtherOptions": {
            "a": "Substrate binding may still occur.",
            "c": "Enzymes are specific to coenzymes.",
            "d": "Amino acids cannot substitute coenzymes.",
            "e": "Free coenzymes do not catalyze reactions."
        },
        "relatedQuestions": ["12 (Km)", "13 (enzyme function)"],
        "category": "Enzymes",
        "difficulty": "Hard"
    },
    {
        "id": 61,
        "question": "In order for lipid-based hormones such as testosterone or estrogen to be transported in the bloodstream, they are bound to and transported by water-soluble proteins. In order to be water-soluble, the transporting protein contains which one of the following amino acids on its surface in contact with aqueous blood?",
        "options": [
            "Valine",
            "Alanine",
            "Leucine",
            "Phenylalanine",
            "Glutamine"
        ],
        "answer": 4,
        "correctAnswer": "Glutamine",
        "explanation": "Glutamine, a polar amino acid, is hydrophilic and found on the surface of water-soluble proteins like those transporting steroid hormones. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 352; Lipids MCQ 11.",
        "whyNotOtherOptions": {
            "a": "Valine is hydrophobic.",
            "b": "Alanine is hydrophobic.",
            "c": "Leucine is hydrophobic.",
            "d": "Phenylalanine is hydrophobic."
        },
        "relatedQuestions": ["Lipids MCQ 11 (lipoproteins)", "59 (lipid transport)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 62,
        "question": "Methanol (CH3OH) is converted by ADH to formaldehyde (CH2O), a compound that is highly toxic to humans. Patients who have ingested toxic levels of methanol are sometimes treated with ethanol (C2H5OH) to inhibit methanol oxidation by ADH. Which one of the following is a competitive analog of methanol and might therefore be an effective following as a competitive analog of methanol and might therefore be an effective treatment?",
        "options": [
            "Ethanol is a structural analog of methanol that can be expected to compete with methanol for binding to the ADH enzyme",
            "In vivo studies indicated that the Km for the ADH for the oxidation of methanol is competitively reduced by ethanol",
            "Ethanol has no effective inhibitory effect of methanol oxidation regardless of the concentration of methanol",
            "Ethanol can be expected to inhibit the enzyme by binding to the formaldehyde-binding site on the enzyme, even though it cannot bind at the substrate binding site for methanol"
        ],
        "answer": 0,
        "correctAnswer": "Ethanol is a structural analog of methanol that can be expected to compete with methanol for binding to the ADH enzyme",
        "explanation": "Ethanol, a structural analog of methanol, competitively inhibits alcohol dehydrogenase (ADH) by binding to its active site, reducing methanol oxidation to toxic formaldehyde. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 6, p. 195.",
        "whyNotOtherOptions": {
            "b": "Ethanol increases Km for methanol.",
            "c": "Ethanol does inhibit methanol oxidation.",
            "d": "Ethanol binds the substrate site, not a formaldehyde site."
        },
        "relatedQuestions": ["12 (Km)", "66 (competitive inhibition)"],
        "category": "Enzymes",
        "difficulty": "Hard"
    },
    {
        "id": 63,
        "question": "In tRNA molecules, there is a 'loop' which contains a minor base:",
        "options": [
            "Cytosine",
            "Dihydrocytosine",
            "Thymine",
            "Dihydrouracil",
            "Uracil"
        ],
        "answer": 3,
        "correctAnswer": "Dihydrouracil",
        "explanation": "The D-loop of tRNA contains dihydrouracil, a modified base. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 980.",
        "whyNotOtherOptions": {
            "a": "Cytosine is a standard base.",
            "b": "Dihydrocytosine is not a tRNA base.",
            "c": "Thymine is in DNA, not tRNA.",
            "e": "Uracil is standard in RNA."
        },
        "relatedQuestions": ["15 (prokaryotic mRNA)", "64 (anticodon)"],
        "category": "Nucleic Acids",
        "difficulty": "Medium"
    },
    {
        "id": 64,
        "question": "The anticodon region is an important part of the structure of:",
        "options": [
            "r-RNA",
            "m-RNA",
            "hn-RNA",
            "t-RNA",
            "Z-DNA"
        ],
        "answer": 3,
        "correctAnswer": "t-RNA",
        "explanation": "The anticodon region of tRNA pairs with mRNA codons during translation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 980.",
        "whyNotOtherOptions": {
            "a": "rRNA is structural in ribosomes.",
            "b": "mRNA has codons, not anticodons.",
            "c": "hnRNA is pre-mRNA.",
            "e": "Z-DNA is a DNA conformation."
        },
        "relatedQuestions": ["15 (prokaryotic mRNA)", "63 (tRNA loop)"],
        "category": "Translation",
        "difficulty": "Easy"
    },
     {
        "id": 65,
        "question": "Which of these statements is not true regarding the cell membrane?",
        "options": [
            "The phosphate heads are polar",
            "It is a phospholipid bilayer",
            "The hydrophilic tails face outwards",
            "It contains integral proteins"
        ],
        "answer": 2,
        "correctAnswer": "The hydrophilic tails face outwards",
        "explanation": "The cell membrane is a phospholipid bilayer with hydrophilic (polar) phosphate heads facing outward and hydrophobic tails facing inward, forming a hydrophobic core. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 346; Lipids MCQ 7.",
        "whyNotOtherOptions": {
            "a": "Phosphate heads are polar, true.",
            "b": "The membrane is a phospholipid bilayer, true.",
            "d": "Integral proteins are embedded in the membrane, true."
        },
        "relatedQuestions": ["Lipids MCQ 7 (phospholipids)", "7 (glycosphingolipids)"],
        "category": "Cell Membranes",
        "difficulty": "Easy"
    },
    {
        "id": 66,
        "question": "An antibiotic is developed that is a close structural analog of a substrate of an enzyme that participates in cell wall synthesis in bacteria. This binding of the antibiotic reduces overall enzyme activity, but such activity can be restored if more substrate is added. The binding of the antibiotic to the enzyme is not via a covalent bond, nor does the enzyme alter the structure of the antibiotic. Which one of the following would best describe this antibiotic?",
        "options": [
            "It is a suicide inhibitor",
            "It is an irreversible inhibitor",
            "It is a competitive inhibitor",
            "It is a noncompetitive inhibitor",
            "p53 directly phosphorylates the transcription factor jun"
        ],
        "answer": 2,
        "correctAnswer": "It is a competitive inhibitor",
        "explanation": "A competitive inhibitor binds non-covalently to the enzymeâ€™s active site, competing with the substrate, and its effect can be overcome by increasing substrate concentration. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 6, p. 195.",
        "whyNotOtherOptions": {
            "a": "Suicide inhibitors bind covalently.",
            "b": "Irreversible inhibitors bind covalently.",
            "d": "Noncompetitive inhibitors bind outside the active site.",
            "e": "p53 is unrelated to enzyme inhibition."
        },
        "relatedQuestions": ["12 (Km)", "62 (ethanol inhibition)"],
        "category": "Enzymes",
        "difficulty": "Medium"
    },
    {
        "id": 67,
        "question": "Which of the following lipids is a major component of lipid rafts in cell membranes?",
        "options": [
            "Triglycerides",
            "Phosphatidylcholine",
            "Sphingomyelin",
            "Glycerol"
        ],
        "answer": 2,
        "correctAnswer": "Sphingomyelin",
        "explanation": "Lipid rafts are membrane domains enriched in sphingomyelin and cholesterol, facilitating signaling and protein sorting. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 349; Lipids MCQ 23.",
        "whyNotOtherOptions": {
            "a": "Triglycerides are for energy storage, not membranes.",
            "b": "Phosphatidylcholine is in membranes but not enriched in rafts.",
            "d": "Glycerol is a backbone, not a lipid."
        },
        "relatedQuestions": ["Lipids MCQ 23 (lipid rafts)", "65 (cell membrane)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 68,
        "question": "The primary function of very low-density lipoproteins (VLDL) is to:",
        "options": [
            "Transport cholesterol to the liver",
            "Transport triglycerides from the liver to tissues",
            "Remove cholesterol from peripheral tissues",
            "Synthesize steroid hormones"
        ],
        "answer": 1,
        "correctAnswer": "Transport triglycerides from the liver to tissues",
        "explanation": "VLDL transports triglycerides synthesized in the liver to peripheral tissues for energy or storage. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 358; Lipids MCQ 11.",
        "whyNotOtherOptions": {
            "a": "HDL transports cholesterol to the liver.",
            "c": "HDL removes cholesterol from tissues.",
            "d": "Steroid hormones are synthesized from cholesterol."
        },
        "relatedQuestions": ["Lipids MCQ 11 (lipoproteins)", "59 (lipid transport)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 69,
        "question": "Which enzyme is critical for the beta-oxidation of fatty acids in mitochondria?",
        "options": [
            "Acetyl-CoA carboxylase",
            "Fatty acid synthase",
            "Acyl-CoA dehydrogenase",
            "HMG-CoA reductase"
        ],
        "answer": 2,
        "correctAnswer": "Acyl-CoA dehydrogenase",
        "explanation": "Acyl-CoA dehydrogenase catalyzes the first step of beta-oxidation, removing electrons from fatty acyl-CoA. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 17, p. 620; Lipids MCQ 27.",
        "whyNotOtherOptions": {
            "a": "Acetyl-CoA carboxylase is for fatty acid synthesis.",
            "b": "Fatty acid synthase is for synthesis, not oxidation.",
            "d": "HMG-CoA reductase is for cholesterol synthesis."
        },
        "relatedQuestions": ["Lipids MCQ 27 (beta-oxidation)", "28 (carnitine)"],
        "category": "Lipid Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 70,
        "question": "Which of the following is a product of glycolysis?",
        "options": [
            "Acetyl-CoA",
            "Pyruvate",
            "Citrate",
            "Oxaloacetate"
        ],
        "answer": 1,
        "correctAnswer": "Pyruvate",
        "explanation": "Glycolysis converts glucose to two molecules of pyruvate, producing ATP and NADH. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 14, p. 520.",
        "whyNotOtherOptions": {
            "a": "Acetyl-CoA is formed in the mitochondria.",
            "c": "Citrate is a TCA cycle intermediate.",
            "d": "Oxaloacetate is a TCA cycle intermediate."
        },
        "relatedQuestions": ["3 (inulin)"],
        "category": "Carbohydrate Metabolism",
        "difficulty": "Easy"
    },
    {
        "id": 71,
        "question": "The pentose phosphate pathway primarily produces:",
        "options": [
            "ATP",
            "NADPH",
            "Glucose",
            "Pyruvate"
        ],
        "answer": 1,
        "correctAnswer": "NADPH",
        "explanation": "The pentose phosphate pathway generates NADPH for biosynthetic reactions and ribose-5-phosphate for nucleotide synthesis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 14, p. 540.",
        "whyNotOtherOptions": {
            "a": "ATP is from glycolysis/TCA.",
            "c": "Glucose is the substrate.",
            "d": "Pyruvate is from glycolysis."
        },
        "relatedQuestions": ["70 (glycolysis)"],
        "category": "Carbohydrate Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 72,
        "question": "Which of the following is a characteristic of glycogen?",
        "options": [
            "Linear polysaccharide",
            "Stored in the liver and muscles",
            "Composed of fructose units",
            "Insoluble in water"
        ],
        "answer": 1,
        "correctAnswer": "Stored in the liver and muscles",
        "explanation": "Glycogen is a branched polysaccharide of glucose, stored in liver and muscle cells for energy. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 7, p. 242.",
        "whyNotOtherOptions": {
            "a": "Glycogen is branched, not linear.",
            "c": "Glycogen is glucose-based.",
            "d": "Glycogen is water-soluble."
        },
        "relatedQuestions": ["3 (inulin)", "70 (glycolysis)"],
        "category": "Carbohydrates",
        "difficulty": "Easy"
    },
    {
        "id": 73,
        "question": "The enzyme that catalyzes the addition of phosphate groups to glucose during glycogenolysis is:",
        "options": [
            "Glycogen synthase",
            "Phosphorylase kinase",
            "Glycogen phosphorylase",
            "Glucokinase"
        ],
        "answer": 2,
        "correctAnswer": "Glycogen phosphorylase",
        "explanation": "Glycogen phosphorylase breaks down glycogen by adding phosphate to release glucose-1-phosphate. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 15, p. 560.",
        "whyNotOtherOptions": {
            "a": "Glycogen synthase builds glycogen.",
            "b": "Phosphorylase kinase activates glycogen phosphorylase.",
            "d": "Glucokinase phosphorylates glucose in glycolysis."
        },
        "relatedQuestions": ["72 (glycogen)"],
        "category": "Carbohydrate Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 74,
        "question": "Which amino acid is essential for the synthesis of heme?",
        "options": [
            "Glycine",
            "Lysine",
            "Proline",
            "Valine"
        ],
        "answer": 0,
        "correctAnswer": "Glycine",
        "explanation": "Glycine is a precursor for heme synthesis, combining with succinyl-CoA to form Î´-aminolevulinic acid. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 18, p. 660.",
        "whyNotOtherOptions": {
            "b": "Lysine is not involved in heme synthesis.",
            "c": "Proline is not involved in heme synthesis.",
            "d": "Valine is not involved in heme synthesis."
        },
        "relatedQuestions": ["9 (amino acids)", "57 (sulfur amino acids)"],
        "category": "Amino Acid Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 75,
        "question": "The primary source of energy for ATP synthesis in mitochondria is:",
        "options": [
            "Proton gradient across the inner membrane",
            "Glucose oxidation in the cytosol",
            "NADPH from the pentose phosphate pathway",
            "Lactate from anaerobic glycolysis"
        ],
        "answer": 0,
        "correctAnswer": "Proton gradient across the inner membrane",
        "explanation": "The proton gradient drives ATP synthesis via oxidative phosphorylation in the mitochondria. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 19, p. 680.",
        "whyNotOtherOptions": {
            "b": "Glucose oxidation feeds the TCA cycle, not direct ATP synthesis.",
            "c": "NADPH is for biosynthesis.",
            "d": "Lactate is from anaerobic metabolism."
        },
        "relatedQuestions": ["42 (mitochondria)"],
        "category": "Mitochondria",
        "difficulty": "Medium"
    },
    {
        "id": 76,
        "question": "Which of the following is a stop codon in the genetic code?",
        "options": [
            "AUG",
            "UAA",
            "GGG",
            "CUA"
        ],
        "answer": 1,
        "correctAnswer": "UAA",
        "explanation": "UAA is a stop codon, signaling the end of translation. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 27, p. 975.",
        "whyNotOtherOptions": {
            "a": "AUG is the start codon.",
            "c": "GGG codes for glycine.",
            "d": "CUA codes for leucine."
        },
        "relatedQuestions": ["26 (genetic code)", "29 (genetic code)"],
        "category": "Genetic Code",
        "difficulty": "Easy"
    },
    {
        "id": 77,
        "question": "The enzyme telomerase is responsible for:",
        "options": [
            "DNA replication",
            "RNA splicing",
            "Telomere extension",
            "Protein synthesis"
        ],
        "answer": 2,
        "correctAnswer": "Telomere extension",
        "explanation": "Telomerase extends telomeres by adding repetitive DNA sequences, preventing chromosome shortening. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 910.",
        "whyNotOtherOptions": {
            "a": "DNA polymerase replicates DNA.",
            "b": "Spliceosomes perform RNA splicing.",
            "d": "Ribosomes synthesize proteins."
        },
        "relatedQuestions": ["21 (DNA replication)"],
        "category": "DNA Replication",
        "difficulty": "Medium"
    },
    {
        "id": 78,
        "question": "Which of the following is a key component of the spliceosome?",
        "options": [
            "DNA polymerase",
            "snRNA",
            "mRNA",
            "tRNA"
        ],
        "answer": 1,
        "correctAnswer": "snRNA",
        "explanation": "Small nuclear RNAs (snRNAs) are key components of the spliceosome, facilitating intron removal from pre-mRNA. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 26, p. 952.",
        "whyNotOtherOptions": {
            "a": "DNA polymerase is for replication.",
            "c": "mRNA is the substrate for splicing.",
            "d": "tRNA is for translation."
        },
        "relatedQuestions": ["23 (introns)"],
        "category": "RNA Processing",
        "difficulty": "Medium"
    },
    {
        "id": 79,
        "question": "The lac repressor is an example of a:",
        "options": [
            "Transcription factor",
            "Splicing factor",
            "Translation initiator",
            "DNA-binding protein"
        ],
        "answer": 3,
        "correctAnswer": "DNA-binding protein",
        "explanation": "The lac repressor binds the operator DNA to regulate transcription in the lac operon. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Transcription factors enhance, not repress.",
            "b": "Splicing factors process RNA.",
            "c": "Translation initiators are proteins like eIFs."
        },
        "relatedQuestions": ["19 (lac operon)", "20 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 80,
        "question": "Which of the following is a function of cholesterol in cell membranes?",
        "options": [
            "Energy storage",
            "Signal transduction",
            "Modulate membrane fluidity",
            "Protein synthesis"
        ],
        "answer": 2,
        "correctAnswer": "Modulate membrane fluidity",
        "explanation": "Cholesterol modulates membrane fluidity by stabilizing the phospholipid bilayer. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 348; Lipids MCQ 9.",
        "whyNotOtherOptions": {
            "a": "Triglycerides store energy.",
            "b": "Lipid rafts aid signaling, not cholesterol directly.",
            "d": "Protein synthesis occurs in ribosomes."
        },
        "relatedQuestions": ["Lipids MCQ 9 (cholesterol)", "65 (cell membrane)"],
        "category": "Lipids",
        "difficulty": "Easy"
    },
    {
        "id": 81,
        "question": "Mutations in the p53 gene are the most common aberrations in spontaneous human cancers. The normal p53 protein affects the cell cycle by",
        "options": [
            "Inducing cell cycle arrest and apoptosis in response to DNA damage",
            "Inducing the phosphorylation of Rb in response to mitogens",
            "Directly inhibiting Cdk inhibitors in response to cell-cell contact and other growth-inhibiting stimuli",
            "Increasing the activity of cyclin-dependent protein kinases by inducing their phosphorylation",
            "Binding and thereby inactivating the products of many proapoptotic genes"
        ],
        "answer": 0,
        "correctAnswer": "Inducing cell cycle arrest and apoptosis in response to DNA damage",
        "explanation": "p53 is a tumor suppressor that induces cell cycle arrest or apoptosis in response to DNA damage, preventing cancer. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 420.",
        "whyNotOtherOptions": {
            "b": "Rb phosphorylation is by cyclins.",
            "c": "p53 activates Cdk inhibitors.",
            "d": "p53 inhibits Cdk activity.",
            "e": "p53 activates proapoptotic genes."
        },
        "relatedQuestions": ["48 (DNA repair)"],
        "category": "Cell Cycle",
        "difficulty": "Hard"
    },
    {
        "id": 82,
        "question": "Which one of the following is not true about M-checkpoint",
        "options": [
            "Anaphase promoting complex/Cyclosome is key regulator",
            "Triggered mainly by activation of specific cyclin-Cdk complexes via phosphorylation or dephosphorylation",
            "Progression of metaphase-to-anaphase transition triggered by cyclical proteolysis",
            "Checks whether alignment of every chromosome on spindle",
            "All are true"
        ],
        "answer": 4,
        "correctAnswer": "All are true",
        "explanation": "The M-checkpoint (spindle checkpoint) ensures chromosome alignment, regulated by the anaphase-promoting complex (APC/C), cyclin-Cdk complexes, and proteolysis. All statements are true. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 415.",
        "whyNotOtherOptions": {
            "a": "APC/C is a key regulator, true.",
            "b": "Cyclin-Cdk activation is involved, true.",
            "c": "Proteolysis triggers anaphase, true.",
            "d": "Checks chromosome alignment, true."
        },
        "relatedQuestions": ["81 (p53)", "83 (cohesin)"],
        "category": "Cell Cycle",
        "difficulty": "Hard"
    },
    {
        "id": 83,
        "question": "The protein that holds the two sister chromatids in place until they are separated is ______.",
        "options": [
            "Kinetochore",
            "Centromere",
            "Cohesin",
            "Securin"
        ],
        "answer": 2,
        "correctAnswer": "Cohesin",
        "explanation": "Cohesin is a protein complex that holds sister chromatids together until anaphase, when it is cleaved by separase. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 415.",
        "whyNotOtherOptions": {
            "a": "Kinetochores attach chromosomes to the spindle.",
            "b": "Centromere is the DNA region, not a protein.",
            "d": "Securin inhibits separase."
        },
        "relatedQuestions": ["82 (M-checkpoint)"],
        "category": "Cell Cycle",
        "difficulty": "Medium"
    },
    {
        "id": 84,
        "question": "What is the name of the protein signaling molecule that alters glucose uptake, and where would its receptors be located?",
        "options": [
            "Insulin; many different cell types that use glucose for fuel",
            "PDGF; the blood",
            "NGF; the nerves involved in simple reflexes",
            "Insulin; beta cells of the pancreas"
        ],
        "answer": 0,
        "correctAnswer": "Insulin; many different cell types that use glucose for fuel",
        "explanation": "Insulin, a hormone, promotes glucose uptake by binding receptors on cells like muscle and fat cells. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 410; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "b": "PDGF promotes cell growth, not glucose uptake.",
            "c": "NGF affects nerve growth.",
            "d": "Insulin receptors are not primarily on beta cells."
        },
        "relatedQuestions": ["Cell Signaling MCQ 1 (insulin)", "44 (signaling stages)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 85,
        "question": "The cell's structural unit that serves as microtubules organizing center and facilitates cell division during mitosis is _______.",
        "options": [
            "Centriole",
            "Ribosome",
            "Endoplasmic Reticulum",
            "All"
        ],
        "answer": 0,
        "correctAnswer": "Centriole",
        "explanation": "Centrioles form the centrosome, the microtubule-organizing center during mitosis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 415.",
        "whyNotOtherOptions": {
            "b": "Ribosomes synthesize proteins.",
            "c": "ER is for protein/lipid synthesis.",
            "d": "Only centrioles serve this role."
        },
        "relatedQuestions": ["82 (M-checkpoint)", "83 (cohesin)"],
        "category": "Cell Cycle",
        "difficulty": "Easy"
    },
    {
        "id": 86,
        "question": "Which of the following processes involve 'the combining of a message from one signaling molecule with that of another to either enhance or inhibit a cellular effect?",
        "options": [
            "Signal transduction",
            "Signal integration",
            "Signal amplification",
            "Signal reception"
        ],
        "answer": 1,
        "correctAnswer": "Signal integration",
        "explanation": "Signal integration combines multiple signaling inputs to modulate cellular responses. Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 7.",
        "whyNotOtherOptions": {
            "a": "Transduction relays signals.",
            "c": "Amplification increases signal strength.",
            "d": "Reception is ligand binding."
        },
        "relatedQuestions": ["Cell Signaling MCQ 7 (integration)", "44 (signaling stages)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 87,
        "question": "Sex chromosomal Monosomy",
        "options": [
            "Edward syndrome",
            "Patau syndrome",
            "Downs syndrome",
            "Turner syndrome",
            "Cri-du-chat syndrome"
        ],
        "answer": 3,
        "correctAnswer": "Turner syndrome",
        "explanation": "Turner syndrome is a sex chromosome monosomy (45,X), caused by the absence of one X chromosome. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 24, p. 870.",
        "whyNotOtherOptions": {
            "a": "Edward syndrome is trisomy 18.",
            "b": "Patau syndrome is trisomy 13.",
            "c": "Down syndrome is trisomy 21.",
            "e": "Cri-du-chat is a deletion syndrome."
        },
        "relatedQuestions": ["48 (DNA repair)"],
        "category": "Genetics",
        "difficulty": "Medium"
    },
    {
        "id": 88,
        "question": "In terms of cell communication, what do bacterial pathogens such as cholera and anthrax have in common?",
        "options": [
            "They destroy the receptors for key signaling molecules",
            "They block the normal functioning of signal transduction mechanisms",
            "They alter the chemical structure of key signaling molecules",
            "They prevent the production of key signaling molecules"
        ],
        "answer": 1,
        "correctAnswer": "They block the normal functioning of signal transduction mechanisms",
        "explanation": "Cholera and anthrax toxins disrupt signal transduction (e.g., cholera toxin increases cAMP by modifying G proteins). Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 19.",
        "whyNotOtherOptions": {
            "a": "They modify signaling, not destroy receptors.",
            "c": "They do not alter signaling molecule structure.",
            "d": "They affect signaling, not production."
        },
        "relatedQuestions": ["Cell Signaling MCQ 19 (pathogens)", "44 (signaling stages)"],
        "category": "Cell Signaling",
        "difficulty": "Hard"
    },
    {
        "id": 89,
        "question": "Each of the following numbered processes are involved in signal transduction pathways: I. Response II. Amplification III. Transduction IV. Reception Which of the following represents the sequence of events in a typical signal transduction pathway?",
        "options": [
            "IV,II,III,I",
            "IV,I,III,II",
            "I,II,III,IV",
            "IV,III,II,I"
        ],
        "answer": 3,
        "correctAnswer": "IV,III,II,I",
        "explanation": "Signal transduction proceeds as reception (IV), transduction (III), amplification (II), and response (I). Reference: Campbell Biology, Chapter 11; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 3.",
        "whyNotOtherOptions": {
            "a": "Amplification follows transduction.",
            "b": "Response follows transduction.",
            "c": "Incorrect order."
        },
        "relatedQuestions": ["Cell Signaling MCQ 3 (signaling stages)", "44 (signaling stages)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 90,
        "question": "The complete expression of the lac operon requires __________.",
        "options": [
            "Lactose",
            "Allolactose",
            "Lactose and cAMP",
            "Allolactose and cAMP"
        ],
        "answer": 3,
        "correctAnswer": "Allolactose and cAMP",
        "explanation": "Lac operon expression requires allolactose to inactivate the repressor and cAMP to activate CAP, enhancing transcription. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 28, p. 1010.",
        "whyNotOtherOptions": {
            "a": "Lactose alone is insufficient without cAMP.",
            "b": "Allolactose alone is insufficient without cAMP.",
            "c": "Lactose needs conversion to allolactose."
        },
        "relatedQuestions": ["19 (lac operon)", "20 (lac operon)"],
        "category": "Gene Regulation",
        "difficulty": "Medium"
    },
    {
        "id": 91,
        "question": "Which of the following is a key feature of apoptosis?",
        "options": [
            "Cell swelling",
            "DNA fragmentation",
            "Membrane rupture",
            "Cytoplasmic leakage"
        ],
        "answer": 1,
        "correctAnswer": "DNA fragmentation",
        "explanation": "Apoptosis involves programmed cell death with DNA fragmentation, unlike necrosis, which causes cell swelling and rupture. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 420.",
        "whyNotOtherOptions": {
            "a": "Swelling occurs in necrosis.",
            "c": "Rupture occurs in necrosis.",
            "d": "Leakage occurs in necrosis."
        },
        "relatedQuestions": ["81 (p53)"],
        "category": "Cell Cycle",
        "difficulty": "Medium"
    },
    {
        "id": 92,
        "question": "The primary role of sphingolipids in cell membranes is to:",
        "options": [
            "Store energy",
            "Form the bilayer structure",
            "Participate in cell signaling",
            "Transport glucose"
        ],
        "answer": 2,
        "correctAnswer": "Participate in cell signaling",
        "explanation": "Sphingolipids, especially in lipid rafts, play roles in cell signaling and membrane organization. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 349; Lipids MCQ 23.",
        "whyNotOtherOptions": {
            "a": "Energy storage is for triglycerides.",
            "b": "Phospholipids form the bilayer.",
            "d": "Glucose transport is protein-mediated."
        },
        "relatedQuestions": ["Lipids MCQ 23 (lipid rafts)", "67 (sphingomyelin)"],
        "category": "Lipids",
        "difficulty": "Medium"
    },
    {
        "id": 93,
        "question": "Which of the following enzymes is inhibited by statins?",
        "options": [
            "Acetyl-CoA carboxylase",
            "HMG-CoA reductase",
            "Fatty acid synthase",
            "Lipoprotein lipase"
        ],
        "answer": 1,
        "correctAnswer": "HMG-CoA reductase",
        "explanation": "Statins inhibit HMG-CoA reductase, the rate-limiting enzyme in cholesterol synthesis. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 21, p. 770; Lipids MCQ 30.",
        "whyNotOtherOptions": {
            "a": "Acetyl-CoA carboxylase is for fatty acid synthesis.",
            "c": "Fatty acid synthase is for fatty acid synthesis.",
            "d": "Lipoprotein lipase hydrolyzes triglycerides."
        },
        "relatedQuestions": ["Lipids MCQ 30 (cholesterol synthesis)", "80 (cholesterol)"],
        "category": "Lipid Metabolism",
        "difficulty": "Medium"
    },
    {
        "id": 94,
        "question": "Which of the following is a characteristic of okazaki fragments?",
        "options": [
            "Synthesized on the leading strand",
            "Joined by DNA ligase",
            "Composed of RNA only",
            "Formed in eukaryotic transcription"
        ],
        "answer": 1,
        "correctAnswer": "Joined by DNA ligase",
        "explanation": "Okazaki fragments are short DNA segments synthesized on the lagging strand during replication, joined by DNA ligase. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 25, p. 895.",
        "whyNotOtherOptions": {
            "a": "They are on the lagging strand.",
            "c": "They are DNA with RNA primers.",
            "d": "They are formed in replication, not transcription."
        },
        "relatedQuestions": ["17 (DNA ligase)", "21 (DNA replication)"],
        "category": "DNA Replication",
        "difficulty": "Medium"
    },
    {
        "id": 95,
        "question": "The role of cyclic GMP (cGMP) in signal transduction is to:",
        "options": [
            "Activate protein kinase A",
            "Activate protein kinase G",
            "Inhibit G-protein receptors",
            "Synthesize cyclic AMP"
        ],
        "answer": 1,
        "correctAnswer": "Activate protein kinase G",
        "explanation": "cGMP acts as a second messenger, activating protein kinase G in signaling pathways. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 410; Khan Academy, Intracellular Signal Transduction.",
        "whyNotOtherOptions": {
            "a": "cAMP activates protein kinase A.",
            "c": "cGMP does not inhibit GPCRs.",
            "d": "cGMP is distinct from cAMP."
        },
        "relatedQuestions": ["Cell Signaling MCQ 12 (cAMP)", "47 (cAMP)"],
        "category": "Cell Signaling",
        "difficulty": "Medium"
    },
    {
        "id": 96,
        "question": "Which of the following is a key function of the Golgi apparatus?",
        "options": [
            "DNA replication",
            "Protein modification and sorting",
            "ATP synthesis",
            "Lipid degradation"
        ],
        "answer": 1,
        "correctAnswer": "Protein modification and sorting",
        "explanation": "The Golgi apparatus modifies, sorts, and packages proteins for secretion or membrane use. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 1, p. 12.",
        "whyNotOtherOptions": {
            "a": "DNA replication occurs in the nucleus.",
            "c": "ATP synthesis is mitochondrial.",
            "d": "Lipid degradation occurs in lysosomes."
        },
        "relatedQuestions": ["46 (lysosomes)"],
        "category": "Cell Biology",
        "difficulty": "Easy"
    },
    {
        "id": 97,
        "question": "Which of the following is a characteristic of unsaturated fatty acids?",
        "options": [
            "Contain only single bonds",
            "Solid at room temperature",
            "Contain one or more double bonds",
            "Primarily store energy"
        ],
        "answer": 2,
        "correctAnswer": "Contain one or more double bonds",
        "explanation": "Unsaturated fatty acids have one or more double bonds, making them liquid at room temperature. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 10, p. 343; Lipids MCQ 5.",
        "whyNotOtherOptions": {
            "a": "Single bonds are in saturated fatty acids.",
            "b": "Unsaturated fats are liquid.",
            "d": "Triglycerides store energy."
        },
        "relatedQuestions": ["Lipids MCQ 5 (unsaturated fatty acids)", "69 (beta-oxidation)"],
        "category": "Lipids",
        "difficulty": "Easy"
    },
    {
        "id": 98,
        "question": "The tricarboxylic acid (TCA) cycle occurs in which cellular compartment?",
        "options": [
            "Cytosol",
            "Mitochondrial matrix",
            "Endoplasmic reticulum",
            "Nucleus"
        ],
        "answer": 1,
        "correctAnswer": "Mitochondrial matrix",
        "explanation": "The TCA cycle (Krebs cycle) occurs in the mitochondrial matrix, oxidizing acetyl-CoA to produce energy. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 16, p. 590.",
        "whyNotOtherOptions": {
            "a": "Cytosol hosts glycolysis.",
            "c": "ER is for protein/lipid synthesis.",
            "d": "Nucleus is for DNA processes."
        },
        "relatedQuestions": ["75 (ATP synthesis)"],
        "category": "Cellular Respiration",
        "difficulty": "Easy"
    },
    {
        "id": 99,
        "question": "Which of the following is a hallmark of cancer cells?",
        "options": [
            "Contact inhibition",
            "Uncontrolled cell division",
            "Dependence on external growth factors",
            "Normal telomere length"
        ],
        "answer": 1,
        "correctAnswer": "Uncontrolled cell division",
        "explanation": "Cancer cells exhibit uncontrolled cell division due to mutations in growth-regulating genes. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 420.",
        "whyNotOtherOptions": {
            "a": "Cancer cells lack contact inhibition.",
            "c": "Cancer cells are growth factor-independent.",
            "d": "Cancer cells have shortened telomeres."
        },
        "relatedQuestions": ["81 (p53)", "87 (monosomy)"],
        "category": "Cell Cycle",
        "difficulty": "Medium"
    },
    {
        "id": 100,
        "question": "Which second messenger is produced by the cleavage of phosphatidylinositol 4,5-bisphosphate (PIP2)?",
        "options": [
            "cAMP",
            "IP3",
            "cGMP",
            "Calcium"
        ],
        "answer": 1,
        "correctAnswer": "IP3",
        "explanation": "PIP2 is cleaved by phospholipase C to produce IP3 and DAG, key second messengers in signaling. Reference: Lehninger Principles of Biochemistry, 7th ed., Chapter 12, p. 410; Khan Academy, Intracellular Signal Transduction; Cell Signaling MCQ 19.",
        "whyNotOtherOptions": {
            "a": "cAMP is produced by adenylyl cyclase.",
            "c": "cGMP is produced by guanylyl cyclase.",
            "d": "Calcium is a second messenger but not a PIP2 product."
        },
        "relatedQuestions": ["Cell Signaling MCQ 19 (G-protein signals)", "40 (protein kinase C)"],
        "category": "Cell Signaling",
        "difficulty": "Hard"
    }
]

;

// Core application variables
const overlay = document.getElementById('overlay');
const menuToggle = document.getElementById('menuToggle');
const sidebar = document.getElementById('sidebar');
const mainContent = document.getElementById('mainContent');
const categoriesGrid = document.getElementById('categoriesGrid');
const themeToggle = document.getElementById('themeToggle');
const quizContainer = document.getElementById('quizContainer');
const resultsScreen = document.getElementById('resultsScreen');
const pageTitle = document.getElementById('pageTitle');
const modeButtons = document.querySelectorAll('.mode-btn');
const correctAnswersEl = document.getElementById('correctAnswers');
const timeSpentEl = document.getElementById('timeSpent');
const masteryLevelEl = document.getElementById('masteryLevel');
const streakCountEl = document.getElementById('streakCount');
const searchInput = document.getElementById('searchInput');
const exportProgressBtn = document.getElementById('exportProgress');
const createCustomQuizBtn = document.getElementById('createCustomQuizBtn');
const customQuizModal = document.getElementById('customQuizModal');
const cancelCustomQuizBtn = document.getElementById('cancelCustomQuiz');
const createCustomQuizBtnModal = document.getElementById('createCustomQuiz');
const weakAreasCountEl = document.getElementById('weakAreasCount');
const avgTimePerQuestionEl = document.getElementById('avgTimePerQuestion');
const improvementRateEl = document.getElementById('improvementRate');

// Navigation elements
const navItems = document.querySelectorAll('.nav-item');

// Application state
let currentMode = 'exam';
let selectedCategories = [];
let currentQuestionIndex = 0;
let score = 0;
let userAnswers = [];
let questions = [];
let incorrectQuestions = [];
let isAnswerChecked = false;
let bookmarkedQuestions = new Set();
let userProgress = {};
let userStats = {
    totalQuestions: 0,
    correctAnswers: 0,
    timeSpent: 0,
    masteryLevel: 0,
    streak: 0,
    lastActive: null,
    weeklyProgress: []
};
let timerInterval = null;
let startTime = null;
let remainingTime = 0;
let isCountdown = false;
let examCheckMode = 'immediate';
let examSubmitted = false;
let questionTimers = [];
let searchResults = [];
let isSearchActive = false;
let currentPage = 'Dashboard';
let customQuestions = [];

// Core application functions
function init() {
    initializeCategories();
    initializeEventListeners();
    initializeNavigation();
    loadUserData();
    updateDashboardStats();
    updateAnalytics();
    showDashboard();
    createFAB();
    updateCustomQuizModalHTML();
}

function createFAB() {
    const fab = document.createElement('button');
    fab.className = 'fab';
    fab.innerHTML = '<i class="fas fa-plus"></i>';
    fab.title = 'Create Custom Question';
    fab.addEventListener('click', showCustomQuestionCreator);
    document.body.appendChild(fab);
}

function initializeNavigation() {
    navItems.forEach((item, index) => {
        item.addEventListener('click', () => {
            navItems.forEach(nav => nav.classList.remove('active'));
            item.classList.add('active');
            
            switch(index) {
                case 0: // Dashboard
                    currentPage = 'Dashboard';
                    showDashboard();
                    break;
                case 1: // My Courses
                    currentPage = 'courses';
                    showCourses();
                    break;
                case 2: // Progress Analytics
                    currentPage = 'analytics';
                    showAnalytics();
                    break;
                case 3: // Bookmarked Questions
                    currentPage = 'bookmarks';
                    showBookmarks();
                    break;
                case 4: // Settings
                    currentPage = 'settings';
                    showSettings();
                    break;
            }
            
            closeSidebar();
        });
    });
}

function showDashboard() {
    console.log('showDashboard called'); // Debug
    
    hideAllSections();
    document.querySelector('.stats-grid').style.display = 'grid';
    document.querySelector('.analytics-section').style.display = 'block';
    document.querySelector('.search-container').style.display = 'block';
    document.querySelector('.export-section').style.display = 'block';
    
    // Reset page title
    pageTitle.textContent = 'Dashboard';
    updateDashboardStats();
    
    // ALWAYS load questions and show quiz layout
    questions = [...quizData, ...customQuestions];
    selectedCategories = [...new Set(questions.map(q => q.category))];
    
    // Reset quiz state
    currentQuestionIndex = 0;
    userAnswers = new Array(questions.length);
    isAnswerChecked = false;
    examSubmitted = false;
    
    console.log('Questions loaded:', questions.length);
    console.log('Current mode:', currentMode);
    
    // Force show quiz container
    quizContainer.classList.remove('hidden');
    resultsScreen.classList.add('hidden');
    
    if (questions.length > 0) {
        console.log('Calling renderQuizLayout...');
        renderQuizLayout();
    } else {
        console.log('No questions, showing message');
        showNoQuestionsMessage();
    }
}

function showCourses() {
    hideAllSections();
    pageTitle.textContent = 'My Courses';
    
    quizContainer.innerHTML = `
        <div style="text-align: center; padding: 40px 20px;">
            <div style="font-size: 80px; color: var(--primary); margin-bottom: 20px; opacity: 0.8;">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h2 style="font-size: 32px; margin-bottom: 16px; color: var(--text-primary); background: linear-gradient(135deg, var(--primary), var(--primary-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700;">Learning Pathways</h2>
            <p style="color: var(--text-secondary); margin-bottom: 40px; max-width: 500px; margin-left: auto; margin-right: auto; font-size: 16px; line-height: 1.6;">
                Structured learning paths designed to build your medical knowledge systematically.
            </p>
           <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 24px; margin-top: 40px;">
                    <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Anatomy Mastery', 'fas fa-brain', '#6366f1', 75, 'Build foundational anatomy knowledge')}
                    </div>
  <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Physiology Deep Dive', 'fas fa-heartbeat', '#06b6d4', 45, 'Understand body systems and functions')}
                   </div>
  <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Clinical Pathology', 'fas fa-virus', '#10b981', 30, 'Study diseases and diagnostics')}
                    </div> 
  <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Pharmacology', 'fas fa-pills', '#f59e0b', 20, 'Master drug mechanisms and effects')}
                    </div>
    <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Medical Imaging', 'fas fa-x-ray', '#8b5cf6', 15, 'Learn radiology and imaging techniques')}
                    </div>
    <div onclick="window.location.href='anatomy.html'" style="cursor: pointer;">
                       ${createCourseCard('Emergency Medicine', 'fas fa-ambulance', '#ef4444', 10, 'Critical care and emergency procedures')}
                    </div>
            </div>
        </div>
    `;
    quizContainer.classList.remove('hidden');
}

function createCourseCard(title, icon, color, progress, description) {
    return `
        <div class="category-card" style="text-align: left; cursor: pointer; border-left: 4px solid ${color};" onclick="startCourse('${title.toLowerCase()}')">
            <div class="category-header">
                <div class="category-icon" style="background: ${color}20; color: ${color};">
                    <i class="${icon}"></i>
                </div>
                <div>
                    <div class="category-name" style="font-size: 16px; font-weight: 600;">${title}</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">${description}</div>
                </div>
            </div>
            <div class="category-stats">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%; background: ${color}"></div>
                </div>
                <div class="progress-text">${progress}%</div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 12px;">
                <span style="font-size: 11px; color: var(--text-tertiary);">${Math.floor(progress/10)}/10 Modules</span>
                <span style="font-size: 11px; color: ${color}; font-weight: 600;">Continue â†’</span>
            </div>
        </div>
    `;
}

function showAnalytics() {
    hideAllSections();
    document.querySelector('.stats-grid').style.display = 'grid';
    document.querySelector('.analytics-section').style.display = 'block';
    document.querySelector('.export-section').style.display = 'block';
    pageTitle.textContent = 'Progress Analytics';
    updateAnalytics();
    
    quizContainer.innerHTML = `
        <div style="padding: 24px;">
            <div class="analytics-section glass-effect" style="border-radius: 24px; padding: 32px;">
                <h3 class="analytics-title" style="font-size: 24px; margin-bottom: 8px;">Performance Insights</h3>
                <p style="color: var(--text-secondary); margin-bottom: 32px;">Detailed analytics to optimize your learning journey</p>
                <div class="analytics-grid">
                    <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                        <div class="analytics-value" style="font-size: 32px; color: var(--primary);">${weakAreasCountEl.textContent}</div>
                        <div class="analytics-label">Areas Needing Focus</div>
                    </div>
                    <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                        <div class="analytics-value" style="font-size: 32px; color: #06b6d4;">${avgTimePerQuestionEl.textContent}</div>
                        <div class="analytics-label">Average Response Time</div>
                    </div>
                    <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                        <div class="analytics-value" style="font-size: 32px; color: #10b981;">${improvementRateEl.textContent}</div>
                        <div class="analytics-label">Weekly Progress Rate</div>
                    </div>
                </div>
            </div>
            
            <div class="glass-effect" style="border-radius: 24px; padding: 32px; margin-top: 24px; border: 1px solid rgba(255, 255, 255, 0.2);">
                <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 24px; color: var(--text-primary);">ðŸ“Š Learning Recommendations</h3>
                <div style="display: grid; gap: 16px;">
                    ${createRecommendation('Focus on Weak Areas', 'fas fa-bullseye', 'var(--primary)', 'Spend 60% of study time on topics below 70% mastery')}
                    ${createRecommendation('Consistent Practice', 'fas fa-chart-line', '#10b981', `Maintain your ${userStats.streak}-day streak for optimal retention`)}
                    ${createRecommendation('Active Recall', 'fas fa-brain', '#8b5cf6', 'Use spaced repetition for better long-term memory')}
                    ${createRecommendation('Mixed Practice', 'fas fa-random', '#f59e0b', 'Combine different topics in single study sessions')}
                </div>
            </div>

            <div class="glass-effect" style="border-radius: 24px; padding: 32px; margin-top: 24px; border: 1px solid rgba(255, 255, 255, 0.2);">
                <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 24px; color: var(--text-primary);">ðŸŽ¯ Study Plan</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    ${createStudyPlanItem('Daily Goal', '50 questions', 'fas fa-calendar-day', '#6366f1')}
                    ${createStudyPlanItem('Weekly Target', '5 hours', 'fas fa-chart-bar', '#06b6d4')}
                    ${createStudyPlanItem('Mastery Goal', '85% overall', 'fas fa-trophy', '#f59e0b')}
                    ${createStudyPlanItem('Weak Topics', '2 sessions/week', 'fas fa-exclamation-triangle', '#ef4444')}
                </div>
            </div>
        </div>
    `;
    quizContainer.classList.remove('hidden');
}

function createRecommendation(title, icon, color, description) {
    return `
        <div style="display: flex; align-items: center; gap: 16px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 16px; border-left: 4px solid ${color};">
            <i class="${icon}" style="color: ${color}; font-size: 24px;"></i>
            <div>
                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">${title}</div>
                <div style="font-size: 14px; color: var(--text-secondary); line-height: 1.5;">${description}</div>
            </div>
        </div>
    `;
}

function createStudyPlanItem(title, value, icon, color) {
    return `
        <div style="text-align: center; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 16px;">
            <i class="${icon}" style="color: ${color}; font-size: 32px; margin-bottom: 12px;"></i>
            <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">${title}</div>
            <div style="font-size: 18px; color: ${color}; font-weight: 700;">${value}</div>
        </div>
    `;
}

function showBookmarks() {
    const bookmarkedQuestionsList = [...quizData, ...customQuestions].filter(q => bookmarkedQuestions.has(q.id));
    hideAllSections();
    pageTitle.textContent = 'Bookmarked Questions';
    
    if (bookmarkedQuestionsList.length === 0) {
        quizContainer.innerHTML = `
            <div style="text-align: center; padding: 80px 20px;">
                <div style="font-size: 96px; color: var(--text-tertiary); margin-bottom: 24px; opacity: 0.5;">
                    <i class="far fa-bookmark"></i>
                </div>
                <h2 style="font-size: 32px; margin-bottom: 16px; color: var(--text-primary);">No Bookmarked Questions Yet</h2>
                <p style="color: var(--text-secondary); margin-bottom: 40px; max-width: 400px; margin-left: auto; margin-right: auto; font-size: 16px; line-height: 1.6;">
                    Click the bookmark icon on any question to save it here for quick review. This is perfect for difficult concepts or important topics you want to revisit.
                </p>
                <button class="quiz-btn" onclick="showDashboard(); navItems[0].click()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 32px; border-radius: 16px;">
                    <i class="fas fa-arrow-left"></i>
                    Explore Questions
                </button>
            </div>
        `;
    } else {
        quizContainer.innerHTML = `
            <div style="padding: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                    <div>
                        <h2 style="font-size: 28px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px;">
                            ${bookmarkedQuestionsList.length} Saved Question${bookmarkedQuestionsList.length !== 1 ? 's' : ''}
                        </h2>
                        <p style="color: var(--text-secondary);">Your personal collection of important questions</p>
                    </div>
                    <button class="quiz-btn" onclick="startBookmarksQuiz()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 24px; border-radius: 16px;">
                        <i class="fas fa-play"></i>
                        Practice Bookmarks
                    </button>
                </div>
                <div style="display: grid; gap: 20px;">
                    ${bookmarkedQuestionsList.map(question => `
                        <div class="question-card glass-effect" style="cursor: pointer; border-radius: 20px; padding: 24px;" onclick="jumpToBookmarkQuestion(${question.id})">
                            <div class="question-header">
                                <div class="question-meta">
                                    <div class="question-number" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark));">Q${question.id}</div>
                                    <div class="question-category glass-effect">${question.category}</div>
                                    <div class="question-difficulty" style="background: ${getDifficultyColor(question.difficulty)};">
                                        ${question.difficulty}
                                    </div>
                                    ${question.custom ? '<div class="question-category glass-effect" style="background: #10b98120; color: #10b981;">Custom</div>' : ''}
                                </div>
                                <div class="question-actions">
                                    <button class="action-btn bookmark-btn" onclick="event.stopPropagation(); toggleBookmark(${question.id}); showBookmarks();" aria-label="Remove Bookmark" style="background: rgba(239, 68, 68, 0.1); color: var(--error);">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="question-text" style="font-size: 16px; line-height: 1.6;">${question.question}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    }
    quizContainer.classList.remove('hidden');
}

// Add this function to handle clicking on individual bookmark questions
function jumpToBookmarkQuestion(questionId) {
    const bookmarkedQuestionsList = [...quizData, ...customQuestions].filter(q => bookmarkedQuestions.has(q.id));
    
    // Start a quiz with just this one question
    questions = [bookmarkedQuestionsList.find(q => q.id === questionId)];
    currentQuestionIndex = 0;
    userAnswers = new Array(questions.length);
    isAnswerChecked = false;
    currentMode = 'quiz';
    
    // Update mode buttons
    modeButtons.forEach(b => b.classList.remove('active'));
    modeButtons[1].classList.add('active'); // Quiz mode
    
    pageTitle.textContent = 'Quiz Mode - Bookmarked Question';
    
    hideAllSections();
    quizContainer.classList.remove('hidden');
    renderQuizLayout();
}

function showSettings() {
    hideAllSections();
    pageTitle.textContent = 'Settings & Preferences';
    
    quizContainer.innerHTML = `
        <div style="padding: 24px; max-width: 800px; margin: 0 auto;">
            <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">ðŸŽ¨ Appearance</h3>
                <p style="color: var(--text-secondary); margin-bottom: 24px;">Customize the look and feel of your study environment</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Theme</label>
                        <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                            <button class="mode-btn ${document.body.classList.contains('dark-mode') ? '' : 'active'}" onclick="setTheme('light')" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-sun"></i>
                                Light Mode
                            </button>
                            <button class="mode-btn ${document.body.classList.contains('dark-mode') ? 'active' : ''}" onclick="setTheme('dark')" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-moon"></i>
                                Dark Mode
                            </button>
                        </div>
                    </div>
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Animation</label>
                        <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                            <button class="mode-btn active" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-bolt"></i>
                                Smooth
                            </button>
                            <button class="mode-btn" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-minus"></i>
                                Minimal
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">âš¡ Study Preferences</h3>
                <p style="color: var(--text-secondary); margin-bottom: 24px;">Optimize your learning experience</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Default Mode</label>
                        <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                            <button class="mode-btn ${currentMode === 'quiz' ? 'active' : ''}" onclick="setDefaultMode('quiz')" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-tasks"></i>
                                Quiz
                            </button>
                            <button class="mode-btn ${currentMode === 'exam' ? 'active' : ''}" onclick="setDefaultMode('exam')" style="border-radius: 12px; padding: 12px 16px;">
                                <i class="fas fa-file-alt"></i>
                                Exam
                            </button>
                        </div>
                    </div>
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Questions Per Session</label>
                        <select class="modern-dropdown" style="width: 100%;" onchange="setQuestionsPerSession(this.value)">
                            <option value="10">10 Questions</option>
                            <option value="25" selected>25 Questions</option>
                            <option value="50">50 Questions</option>
                            <option value="100">100 Questions</option>
                            <option value="0">All Questions</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">ðŸ“Š Data & Progress</h3>
                <p style="color: var(--text-secondary); margin-bottom: 24px;">Manage your learning data</p>
                <div style="display: flex; flex-direction: column; gap: 16px;">
                    <button class="quiz-btn" onclick="exportProgress()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                        <i class="fas fa-download" style="margin-right: 12px;"></i>
                         
                    </button>
                    <button class="quiz-btn" onclick="showCustomQuestionCreator()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                        <i class="fas fa-plus" style="margin-right: 12px;"></i>
                        Create Custom Question
                    </button>
                    <button class="quiz-btn" onclick="resetProgress()" style="background: linear-gradient(135deg, var(--error), #dc2626); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                        <i class="fas fa-trash" style="margin-right: 12px;"></i>
                        Reset All Progress
                    </button>
                </div>
            </div>

            <div class="settings-panel" style="padding: 32px;">
                <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">â„¹ï¸ About ALIF</h3>
                <div style="color: var(--text-secondary); line-height: 1.7;">
                    <p>ALIF is an advanced medical education platform designed to help medical students and professionals enhance their knowledge through interactive quizzes and detailed analytics.</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 20px;">
                        <div>
                            <strong style="color: var(--text-primary);">Version</strong>
                            <div>2.1.0</div>
                        </div>
                        <div>
                            <strong style="color: var(--text-primary);">Questions</strong>
                            <div>${quizData.length + customQuestions.length} total</div>
                        </div>
                        <div>
                            <strong style="color: var(--text-primary);">Last Updated</strong>
                            <div>${new Date().toLocaleDateString()}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    quizContainer.classList.remove('hidden');
}

function setTheme(theme) {
    if (theme === 'dark') {
        document.body.classList.add('dark-mode');
        themeToggle.querySelector('i').className = 'fas fa-sun';
    } else {
        document.body.classList.remove('dark-mode');
        themeToggle.querySelector('i').className = 'fas fa-moon';
    }
    showNotification(`Theme set to ${theme} mode`, 'success');
}

function setDefaultMode(mode) {
    currentMode = mode;
    modeButtons.forEach(b => b.classList.remove('active'));
    modeButtons[mode === 'quiz' ? 1 : 0].classList.add('active');
    showNotification(`Default mode set to ${mode}`, 'success');
}

function setQuestionsPerSession(count) {
    showNotification(`Questions per session set to ${count === '0' ? 'all' : count}`, 'info');
}

function showCustomQuestionCreator() {
    const modal = document.createElement('div');
    modal.className = 'custom-quiz-modal active';
    modal.innerHTML = `
        <div class="custom-quiz-content glass-effect" style="max-width: 600px; border-radius: 24px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h3 style="font-size: 24px; font-weight: 700; color: var(--text-primary);">Create Custom Question</h3>
                <button class="action-btn" onclick="closeCustomQuestionModal()" style="background: rgba(239, 68, 68, 0.1); color: var(--error);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="custom-question-creator">
                <div style="display: grid; gap: 20px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">Question Text (Markdown supported for tables)</label>
                        <textarea id="customQuestionText" placeholder="Enter your question here... Use Markdown for tables, e.g., | Col1 | Col2 |" style="width: 100%; padding: 16px; border: 2px solid var(--border); border-radius: 16px; background: var(--surface); color: var(--text-primary); font-size: 14px; resize: vertical; min-height: 100px;"></textarea>
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">Image URL (optional)</label>
                        <input type="url" id="customImageUrl" placeholder="https://example.com/image.jpg" style="width: 100%; padding: 16px; border: 2px solid var(--border); border-radius: 16px; background: var(--surface); color: var(--text-primary); font-size: 14px;">
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">Category</label>
                        <select id="customQuestionCategory" class="modern-dropdown" style="width: 100%;">
                            <option value="Custom Anatomy">Custom Anatomy</option>
                            <option value="Custom Physiology">Custom Physiology</option>
                            <option value="Custom Pathology">Custom Pathology</option>
                            <option value="Custom Pharmacology">Custom Pharmacology</option>
                            <option value="General Medicine">General Medicine</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">Difficulty</label>
                        <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                            <button type="button" class="mode-btn difficulty-btn active" data-difficulty="Easy" style="border-radius: 12px; padding: 12px 16px;">
                                Easy
                            </button>
                            <button type="button" class="mode-btn difficulty-btn" data-difficulty="Medium" style="border-radius: 12px; padding: 12px 16px;">
                                Medium
                            </button>
                            <button type="button" class="mode-btn difficulty-btn" data-difficulty="Hard" style="border-radius: 12px; padding: 12px 16px;">
                                Hard
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Options</label>
                        <div style="display: grid; gap: 12px;">
                            ${['A', 'B', 'C', 'D'].map(letter => `
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 32px; height: 32px; border-radius: 50%; background: var(--surface); display: flex; align-items: center; justify-content: center; font-weight: 600; color: var(--text-secondary); flex-shrink: 0;">${letter}</div>
                                    <input type="text" id="customOption${letter}" placeholder="Option ${letter}" style="flex: 1; padding: 12px 16px; border: 2px solid var(--border); border-radius: 12px; background: var(--surface); color: var(--text-primary);">
                                    <input type="radio" name="correctAnswer" value="${letter}" id="correct${letter}" style="transform: scale(1.2);">
                                    <label for="correct${letter}" style="color: var(--text-secondary); font-weight: 600;">Correct</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 8px; font-weight: 600;">Explanation</label>
                        <textarea id="customExplanation" placeholder="Explain why the correct answer is right..." style="width: 100%; padding: 16px; border: 2px solid var(--border); border-radius: 16px; background: var(--surface); color: var(--text-primary); font-size: 14px; resize: vertical; min-height: 80px;"></textarea>
                    </div>
                </div>
                
                <div class="custom-quiz-actions" style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 32px;">
                    <button class="quiz-btn" onclick="closeCustomQuestionModal()" style="background: var(--secondary); color: white; padding: 12px 24px; border-radius: 12px;">
                        Cancel
                    </button>
                    <button class="quiz-btn check-btn" onclick="saveCustomQuestion()" style="padding: 12px 24px; border-radius: 12px;">
                        <i class="fas fa-save"></i>
                        Save Question
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Add difficulty button handlers
    modal.querySelectorAll('.difficulty-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            modal.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
        });
    });
}

function closeCustomQuestionModal() {
    const modal = document.querySelector('.custom-quiz-modal');
    if (modal) {
        modal.remove();
    }
}

function saveCustomQuestion() {
    const questionText = document.getElementById('customQuestionText').value;
    const imageUrl = document.getElementById('customImageUrl').value || '';
    const category = document.getElementById('customQuestionCategory').value;
    const difficulty = document.querySelector('.difficulty-btn.active').dataset.difficulty;
    const explanation = document.getElementById('customExplanation').value;
    
    // Get options
    const options = [];
    for (let letter of ['A', 'B', 'C', 'D']) {
        const optionText = document.getElementById(`customOption${letter}`).value;
        if (optionText.trim()) {
            options.push(optionText);
        }
    }
    
    // Get correct answer
    const correctAnswerRadio = document.querySelector('input[name="correctAnswer"]:checked');
    if (!correctAnswerRadio) {
        showNotification('Please select the correct answer', 'error');
        return;
    }
    
    const correctAnswerIndex = ['A', 'B', 'C', 'D'].indexOf(correctAnswerRadio.value);
    
    if (!questionText.trim() || options.length < 2) {
        showNotification('Please fill in all required fields', 'error');
        return;
    }
    
    // Generate a unique ID for the custom question
    const maxId = Math.max(
        ...quizData.map(q => q.id),
        ...customQuestions.map(q => q.id),
        0
    );
    
    const newQuestion = {
        id: maxId + 1,
        question: questionText,
        options: options,
        answer: correctAnswerIndex,
        correctAnswer: options[correctAnswerIndex],
        explanation: explanation || 'No explanation provided.',
        whyNotOtherOptions: {},
        relatedQuestions: [],
        category: category,
        difficulty: difficulty,
        custom: true,
        image: imageUrl
    };
    
    customQuestions.push(newQuestion);
    saveUserData();
    
    closeCustomQuestionModal();
    showNotification('Custom question created successfully!', 'success');
    
    // Refresh the current view and categories
    initializeCategories();
    if (currentPage === 'Dashboard') {
        showDashboard();
    } else if (currentPage === 'bookmarks') {
        showBookmarks();
    }
}

function hideAllSections() {
    quizContainer.classList.add('hidden');
    resultsScreen.classList.add('hidden');
    document.querySelector('.stats-grid').style.display = 'none';
    document.querySelector('.analytics-section').style.display = 'none';
    document.querySelector('.export-section').style.display = 'none';
    // Note: search-container is NOT hidden here - we want it always visible during search
}

function startCourse(courseName) {
    showNotification(`Starting ${courseName} course...`, 'info');
    // Filter questions by course/category and start quiz
    const courseQuestions = [...quizData, ...customQuestions].filter(q => 
        q.category.toLowerCase().includes(courseName.toLowerCase())
    );
    
    if (courseQuestions.length === 0) {
        showNotification('No questions available for this course yet', 'info');
        return;
    }
    
    questions = courseQuestions;
    currentQuestionIndex = 0;
    userAnswers = new Array(questions.length);
    isAnswerChecked = false;
    currentMode = 'quiz';
    modeButtons.forEach(b => b.classList.remove('active'));
    modeButtons[1].classList.add('active');
    pageTitle.textContent = `Quiz Mode - ${courseName}`;
    
    hideAllSections();
    quizContainer.classList.remove('hidden');
    renderQuizLayout();
}

// FIXED BOOKMARK PRACTICE FUNCTION
function startBookmarksQuiz() {
    const bookmarkedQuestionsList = [...quizData, ...customQuestions].filter(q => bookmarkedQuestions.has(q.id));
    
    if (bookmarkedQuestionsList.length === 0) {
        showNotification('No bookmarked questions to practice!', 'error');
        return;
    }
    
    questions = bookmarkedQuestionsList;
    currentQuestionIndex = 0;
    userAnswers = new Array(questions.length);
    isAnswerChecked = false;
    currentMode = 'quiz';
    
    // Update mode buttons
    modeButtons.forEach(b => b.classList.remove('active'));
    modeButtons[1].classList.add('active'); // Quiz mode
    
    pageTitle.textContent = 'Quiz Mode - Bookmarked Questions';
    
    hideAllSections();
    quizContainer.classList.remove('hidden');
    renderQuizLayout();
    
    showNotification(`Starting practice with ${questions.length} bookmarked questions`, 'success');
}

function resetProgress() {
    if (confirm('Are you sure you want to reset all your progress? This action cannot be undone.')) {
        userProgress = {};
        userStats = {
            totalQuestions: 0,
            correctAnswers: 0,
            timeSpent: 0,
            masteryLevel: 0,
            streak: 0,
            lastActive: new Date().toISOString(),
            weeklyProgress: []
        };
        bookmarkedQuestions = new Set();
        customQuestions = [];
        saveUserData();
        updateDashboardStats();
        updateAnalytics();
        showNotification('All progress has been reset', 'success');
        showDashboard();
    }
}

function initializeEventListeners() {
    menuToggle.addEventListener('click', toggleSidebar);
    overlay.addEventListener('click', closeSidebar);
    themeToggle.addEventListener('click', toggleTheme);
    
    modeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            modeButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentMode = btn.dataset.mode;
            pageTitle.textContent = `${btn.dataset.mode.charAt(0).toUpperCase() + btn.dataset.mode.slice(1)} Mode`;
            startQuiz();
        });
    });
    
    initializeEnhancedFeatures();
    document.getElementById('backBtn').addEventListener('click', function(e) {
        e.preventDefault();
        // Use browser back navigation
        window.history.back();
    });
}
function updateBackButton() {
    const backBtn = document.getElementById('backBtn');
    // Show back button if there's history to go back to
    if (window.history.length > 1) {
        backBtn.style.display = 'flex';
    } else {
        backBtn.style.display = 'none';
    }
}

function toggleSidebar() {
    sidebar.classList.toggle('open');
    overlay.classList.toggle('active');
    mainContent.classList.toggle('sidebar-open');
    document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : '';
}

function closeSidebar() {
    sidebar.classList.remove('open');
    overlay.classList.remove('active');
    mainContent.classList.remove('sidebar-open');
    document.body.style.overflow = '';
}

function toggleTheme() {
    document.body.classList.toggle('dark-mode');
    const icon = themeToggle.querySelector('i');
    if (document.body.classList.contains('dark-mode')) {
        icon.className = 'fas fa-sun';
    } else {
        icon.className = 'fas fa-moon';
    }
}

function initializeEnhancedFeatures() {
    initializeSearch();
    initializeKeyboardNavigation();
    enhanceAccessibility();
    
    exportProgressBtn.addEventListener('click', exportProgress);
    createCustomQuizBtn.addEventListener('click', () => {
        customQuizModal.classList.add('active');
    });
    cancelCustomQuizBtn.addEventListener('click', () => {
        customQuizModal.classList.remove('active');
    });
    createCustomQuizBtnModal.addEventListener('click', () => {
        const selectedOptions = document.querySelectorAll('.custom-quiz-option.selected');
        const options = {
            categories: selectedCategories,
            difficulty: null,
            bookmarkedOnly: false
        };
        
        selectedOptions.forEach(option => {
            const category = option.dataset.category;
            if (category === 'easy' || category === 'medium' || category === 'hard') {
                options.difficulty = category;
            } else if (category === 'bookmarked') {
                options.bookmarkedOnly = true;
            }
        });
        
        createCustomQuiz(options);
    });
    
    // Add selection toggling for custom quiz options
    document.addEventListener('click', (e) => {
        if (e.target.closest('.custom-quiz-option')) {
            const option = e.target.closest('.custom-quiz-option');
            option.classList.toggle('selected');
        }
    });
    
    // Ensure search works when clicking Dashboard
    navItems[0].addEventListener('click', () => {
        if (searchInput.value.trim().length > 0) {
            // If there's a search query, maintain search state
            isSearchActive = true;
        }
    });
}

// FIXED SEARCH FUNCTIONALITY
function initializeSearch() {
    if (searchInput) {
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.trim().toLowerCase();
            
            // Clear previous search state when input is empty
            if (query.length === 0) {
                document.body.classList.remove('search-blur-active');
                isSearchActive = false;
                if (currentPage === 'Dashboard') {
                    showDashboard();
                }
                return;
            }
            
            // Add blur effect when searching
            document.body.classList.add('search-blur-active');
            
            if (query.length < 2) {
                isSearchActive = false;
                return;
            }
            
            isSearchActive = true;
            performSearch(query);
        });
        
        // Add clear search functionality
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                clearSearch();
            }
        });
    }
}

function performSearch(query) {
    const allQuestions = [...quizData, ...customQuestions];
    searchResults = allQuestions.filter(q => 
        q.question.toLowerCase().includes(query) ||
        q.category.toLowerCase().includes(query) ||
        (q.explanation && q.explanation.toLowerCase().includes(query)) ||
        q.options.some(opt => opt.toLowerCase().includes(query))
    );
    
    console.log('Search query:', query, 'Results:', searchResults.length); // Debug log
    
    if (searchResults.length > 0) {
        // Show search results in quiz layout
        questions = searchResults;
        currentQuestionIndex = 0;
        userAnswers = new Array(questions.length);
        isAnswerChecked = false;
        
        hideAllSections();
        quizContainer.classList.remove('hidden');
        renderQuizLayout();
        
        // Update page title to show search context
        pageTitle.textContent = `Search: "${query}" (${searchResults.length} results)`;
        
        // Highlight search terms
        setTimeout(() => {
            highlightSearchTerms(query);
        }, 100);
    } else {
        // Show no results message
        showSearchNoResults(query);
    }
}

function showSearchNoResults(query) {
    hideAllSections();
    quizContainer.innerHTML = `
        <div class="no-questions" style="text-align: center; padding: 80px 20px;">
            <div style="font-size: 64px; color: var(--text-tertiary); margin-bottom: 24px; opacity: 0.5;">
                <i class="fas fa-search"></i>
            </div>
            <h2 style="font-size: 28px; margin-bottom: 16px; color: var(--text-primary);">No Results Found</h2>
            <p style="color: var(--text-secondary); margin-bottom: 32px; max-width: 400px; margin-left: auto; margin-right: auto;">
                No questions match your search for "<strong style="color: var(--primary);">${query}</strong>". Try different keywords or browse categories.
            </p>
            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                <button class="quiz-btn" onclick="clearSearch()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 12px 24px; border-radius: 12px;">
                    <i class="fas fa-times"></i>
                    Clear Search
                </button>
                <button class="quiz-btn" onclick="toggleSidebar()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 12px 24px; border-radius: 12px;">
                    <i class="fas fa-folder-open"></i>
                    Browse Categories
                </button>
            </div>
        </div>
    `;
    quizContainer.classList.remove('hidden');
    pageTitle.textContent = `Search: "${query}" (0 results)`;
}

function clearSearch() {
    searchInput.value = '';
    document.body.classList.remove('search-blur-active');
    isSearchActive = false;
    showDashboard();
}

function highlightSearchTerms(query) {
    const questionTexts = document.querySelectorAll('.question-text');
    const optionTexts = document.querySelectorAll('.option-text');
    const categoryElements = document.querySelectorAll('.question-category');
    
    const highlightText = (element) => {
        const originalText = element.innerHTML;  // Use innerHTML to preserve Markdown
        const regex = new RegExp(`(${query})`, 'gi');
        const highlighted = originalText.replace(regex, '<mark class="search-highlight">$1</mark>');
        element.innerHTML = highlighted;
    };
    
    questionTexts.forEach(highlightText);
    optionTexts.forEach(highlightText);
    categoryElements.forEach(highlightText);
}

function initializeKeyboardNavigation() {
    document.addEventListener('keydown', (e) => {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
        
        switch(e.key) {
            case 'ArrowDown':
            case 'ArrowUp':
                e.preventDefault();
                navigateOptions(e.key === 'ArrowDown' ? 1 : -1);
                break;
            case ' ':
            case 'Enter':
                e.preventDefault();
                if (document.activeElement.classList.contains('option')) {
                    document.activeElement.click();
                }
                break;
            case '1':
            case '2':
            case '3':
            case '4':
            case '5':
                e.preventDefault();
                const index = parseInt(e.key) - 1;
                const options = document.querySelectorAll('.option:not(.disabled)');
                if (options[index]) {
                    options[index].click();
                }
                break;
            case 'Escape':
                if (document.querySelector('.custom-quiz-modal')) {
                    document.querySelector('.custom-quiz-modal').remove();
                }
                break;
        }
    });
}

function navigateOptions(direction) {
    const options = document.querySelectorAll('.option:not(.disabled)');
    const currentIndex = Array.from(options).findIndex(opt => opt === document.activeElement);
    let nextIndex = currentIndex + direction;
    
    if (nextIndex < 0) nextIndex = options.length - 1;
    if (nextIndex >= options.length) nextIndex = 0;
    
    options[nextIndex].focus();
}

function enhanceAccessibility() {
    document.addEventListener('click', (e) => {
        if (e.target.classList.contains('option')) {
            const options = e.target.parentElement.querySelectorAll('.option');
            options.forEach((opt, index) => {
                opt.setAttribute('aria-checked', opt.classList.contains('selected') ? 'true' : 'false');
                opt.setAttribute('role', 'radio');
                opt.setAttribute('tabindex', '0');
            });
        }
    });
}

function loadUserData() {
    const savedProgress = localStorage.getItem('mediQuizProgress');
    const savedStats = localStorage.getItem('mediQuizStats');
    const savedBookmarks = localStorage.getItem('mediQuizBookmarks');
    const savedCustomQuestions = localStorage.getItem('mediQuizCustomQuestions');
    
    if (savedProgress) {
        userProgress = JSON.parse(savedProgress);
    }
    if (savedStats) {
        userStats = JSON.parse(savedStats);
        const today = new Date().toDateString();
        const lastActive = new Date(userStats.lastActive).toDateString();
        if (lastActive !== today) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            if (lastActive === yesterday.toDateString()) {
                userStats.streak++;
            } else {
                userStats.streak = 1;
            }
        }
    }
    if (savedBookmarks) {
        bookmarkedQuestions = new Set(JSON.parse(savedBookmarks));
    }
    if (savedCustomQuestions) {
        customQuestions = JSON.parse(savedCustomQuestions);
    }
    
    userStats.lastActive = new Date().toISOString();
    saveUserData();
}

function saveUserData() {
    localStorage.setItem('mediQuizProgress', JSON.stringify(userProgress));
    localStorage.setItem('mediQuizStats', JSON.stringify(userStats));
    localStorage.setItem('mediQuizBookmarks', JSON.stringify(Array.from(bookmarkedQuestions)));
    localStorage.setItem('mediQuizCustomQuestions', JSON.stringify(customQuestions));
}

function updateDashboardStats() {
    correctAnswersEl.textContent = userStats.correctAnswers;
    timeSpentEl.textContent = `${Math.floor(userStats.timeSpent / 60)}h ${userStats.timeSpent % 60}m`;
    masteryLevelEl.textContent = `${userStats.masteryLevel}%`;
    streakCountEl.textContent = userStats.streak;
}

function updateAnalytics() {
    const allQuestions = [...quizData, ...customQuestions];
    const weakAreas = Object.entries(userProgress)
        .filter(([_, data]) => data.attempts > 0 && (data.correct / data.attempts) < 0.6)
        .map(([id, _]) => allQuestions.find(q => q.id == id)?.category)
        .reduce((acc, category) => {
            acc[category] = (acc[category] || 0) + 1;
            return acc;
        }, {});
        
    weakAreasCountEl.textContent = Object.keys(weakAreas).length;
    
    const totalTime = userStats.timeSpent * 60;
    const avgTime = userStats.totalQuestions > 0 ? Math.round(totalTime / userStats.totalQuestions) : 0;
    avgTimePerQuestionEl.textContent = `${avgTime}s`;
    
    if (userStats.weeklyProgress.length > 1) {
        const latest = userStats.weeklyProgress[userStats.weeklyProgress.length - 1];
        const previous = userStats.weeklyProgress[userStats.weeklyProgress.length - 2];
        const improvement = ((latest - previous) / previous) * 100;
        improvementRateEl.textContent = `${Math.round(improvement)}%`;
    } else {
        improvementRateEl.textContent = "0%";
    }
}

function exportProgress() {
    const data = {
        progress: userProgress,
        stats: userStats,
        bookmarks: Array.from(bookmarkedQuestions),
        customQuestions: customQuestions,
        exportDate: new Date().toISOString(),
        analytics: generateStudyReport()
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `mediquiz-progress-${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    showNotification('Progress data exported successfully!', 'success');
}

function createCustomQuiz(options) {
    let filteredQuestions = [...quizData, ...customQuestions];
    
    if (options.categories && options.categories.length > 0) {
        filteredQuestions = filteredQuestions.filter(q => options.categories.includes(q.category));
    }
    
    if (options.difficulty) {
        filteredQuestions = filteredQuestions.filter(q => q.difficulty.toLowerCase() === options.difficulty);
    }
    
    if (options.bookmarkedOnly) {
        filteredQuestions = filteredQuestions.filter(q => bookmarkedQuestions.has(q.id));
    }
    
    if (options.count && options.count > 0) {
        filteredQuestions = shuffleArray(filteredQuestions).slice(0, options.count);
    }
    
    questions = filteredQuestions;
    currentQuestionIndex = 0;
    userAnswers = new Array(questions.length);
    isAnswerChecked = false;
    examSubmitted = false;
    
    if (questions.length === 0) {
        showNoQuestionsMessage();
        return;
    }
    
    hideAllSections();
    quizContainer.classList.remove('hidden');
    renderQuizLayout();
    customQuizModal.classList.remove('active');
    showNotification(`Custom quiz created with ${questions.length} questions`, 'success');
}

function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}


function generateStudyReport() {
    const allQuestions = [...quizData, ...customQuestions];
    const weakAreas = Object.entries(userProgress)
        .filter(([_, data]) => data.attempts > 0 && (data.correct / data.attempts) < 0.6)
        .map(([id, _]) => {
            const question = allQuestions.find(q => q.id == id);
            return {
                questionId: id,
                category: question?.category,
                difficulty: question?.difficulty,
                performance: userProgress[id].correct / userProgress[id].attempts
            };
        });
        
    const strongAreas = Object.entries(userProgress)
        .filter(([_, data]) => data.attempts > 0 && (data.correct / data.attempts) >= 0.8)
        .map(([id, _]) => {
            const question = allQuestions.find(q => q.id == id);
            return {
                questionId: id,
                category: question?.category,
                difficulty: question?.difficulty,
                performance: userProgress[id].correct / userProgress[id].attempts
            };
        });
        
    return {
        weakAreas,
        strongAreas,
        totalMastered: Object.values(userProgress).filter(p => p.correct >= 3).length,
        totalQuestions: allQuestions.length,
        masteryPercentage: calculateMasteryLevel(),
        generatedAt: new Date().toISOString()
    };
}

function showNotification(message, type = 'info') {
    // Remove existing notifications
    document.querySelectorAll('.notification').forEach(n => n.remove());
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.style.cssText = `
        position: fixed;
        top: 30px;
        right: 30px;
        padding: 20px 28px;
        background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--error)' : 'var(--primary)'};
        color: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        z-index: 10000;
        transform: translateX(100%);
        transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        backdrop-filter: blur(30px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        font-weight: 600;
        max-width: 400px;
        line-height: 1.5;
    `;
    notification.innerHTML = `
        <div style="display: flex; align-items: center; gap: 12px;">
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'}" style="font-size: 20px;"></i>
            <span>${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (document.body.contains(notification)) {
                document.body.removeChild(notification);
            }
        }, 400);
    }, 4000);
}

function initializeCategories() {
    const allQuestions = [...quizData, ...customQuestions];
    const categories = [...new Set(allQuestions.map(q => q.category))];
    const categoryIcons = {
        "Anatomy Fundamentals": "fas fa-brain",
        "Neuroanatomy": "fas fa-brain",
        "Gastrointestinal System": "fas fa-stomach",
        "Cardiovascular System": "fas fa-heart",
        "Custom Anatomy": "fas fa-user-md",
        "Custom Physiology": "fas fa-heartbeat",
        "Custom Pathology": "fas fa-virus",
        "Custom Pharmacology": "fas fa-pills",
        "General Medicine": "fas fa-stethoscope"
    };
    
    const categoryColors = {
        "Anatomy Fundamentals": "#6366f1",
        "Neuroanatomy": "#06b6d4",
        "Gastrointestinal System": "#10b981",
        "Cardiovascular System": "#ef4444",
        "Custom Anatomy": "#8b5cf6",
        "Custom Physiology": "#f59e0b",
        "Custom Pathology": "#ec4899",
        "Custom Pharmacology": "#84cc16",
        "General Medicine": "#64748b"
    };

    categoriesGrid.innerHTML = '';
    categories.forEach(category => {
        const categoryQuestions = allQuestions.filter(q => q.category === category);
        const mastered = categoryQuestions.filter(q =>
            userProgress[q.id] && userProgress[q.id].correct >= 3
        ).length;
        const progress = categoryQuestions.length > 0 ?
            Math.round((mastered / categoryQuestions.length) * 100) : 0;
            
        const categoryCard = document.createElement('div');
        categoryCard.className = 'category-card active glass-effect';
        categoryCard.dataset.category = category;
        categoryCard.style.borderLeft = `4px solid ${categoryColors[category] || '#6366f1'}`;
        categoryCard.innerHTML = `
            <div class="category-header">
                <div class="category-icon" style="background: ${categoryColors[category] || '#6366f1'}20; color: ${categoryColors[category] || '#6366f1'}">
                    <i class="${categoryIcons[category] || 'fas fa-question'}"></i>
                </div>
                <div class="category-name">${category}</div>
                ${category.includes('Custom') ? '<div style="font-size: 10px; color: var(--primary); background: var(--primary-light); padding: 2px 6px; border-radius: 8px;">Custom</div>' : ''}
            </div>
            <div class="category-stats">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%; background: ${categoryColors[category] || '#6366f1'}"></div>
                </div>
                <div class="progress-text">${progress}%</div>
            </div>
            <div style="font-size: 11px; color: var(--text-tertiary); margin-top: 8px;">
                ${categoryQuestions.length} question${categoryQuestions.length !== 1 ? 's' : ''}
                ${categoryQuestions.filter(q => q.custom).length > 0 ? ` Â· ${categoryQuestions.filter(q => q.custom).length} custom` : ''}
            </div>
        `;
        
        if (categoryQuestions.length > 1) {
            const dropdown = document.createElement('div');
            dropdown.className = 'modern-dropdown';
            dropdown.innerHTML = `
                <select onchange="jumpToQuestion(this.value)">
                    <option value="">Jump to Question...</option>
                    ${categoryQuestions.sort((a, b) => a.id - b.id).map(q => 
                        `<option value="question-${q.id}">Q${q.id}: ${q.question.substring(0, 50)}${q.question.length > 50 ? '...' : ''}${q.custom ? ' â˜…' : ''}</option>`
                    ).join('')}
                </select>
            `;
            categoryCard.appendChild(dropdown);
        }
        
        categoryCard.addEventListener('click', (e) => {
            if (!e.target.closest('.modern-dropdown') && !e.target.closest('select')) {
                toggleCategory(categoryCard);
                const firstQ = categoryQuestions.sort((a, b) => a.id - b.id)[0];
                if (firstQ) {
                    jumpToQuestion(`question-${firstQ.id}`);
                }
            }
        });
        
        categoriesGrid.appendChild(categoryCard);
    });
    
    selectedCategories = [...categories];
}

function toggleCategory(categoryCard) {
    const category = categoryCard.dataset.category;
    if (categoryCard.classList.contains('active')) {
        categoryCard.classList.remove('active');
        selectedCategories = selectedCategories.filter(c => c !== category);
    } else {
        categoryCard.classList.add('active');
        selectedCategories.push(category);
    }
    startQuiz();
    closeSidebar();
}

function startQuiz() {
    if (currentPage !== 'Dashboard') return;
    
    quizContainer.style.opacity = '0';
    setTimeout(() => {
        const allQuestions = [...quizData, ...customQuestions];
        questions = selectedCategories.length > 0 ? 
            allQuestions.filter(q => selectedCategories.includes(q.category)) : 
            allQuestions;
            
        if (questions.length === 0) {
            showNoQuestionsMessage();
            return;
        }
        if (currentMode === 'learn' && incorrectQuestions.length > 0) {
            questions = allQuestions.filter(q => incorrectQuestions.includes(q.id));
        }
        if (questions.length === 0) {
            showNoQuestionsMessage();
            return;
        }
        questions.sort((a, b) => a.id - b.id);
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = new Array(questions.length);
        isAnswerChecked = false;
        examSubmitted = false;
        quizContainer.classList.remove('hidden');
        resultsScreen.classList.add('hidden');
        questionTimers = new Array(questions.length).fill(0);
        if (currentMode === 'exam') {
            isCountdown = true;
            remainingTime = 120 * questions.length;
        } else {
            isCountdown = false;
        }
        startTimer();
        renderQuizLayout();
        quizContainer.style.opacity = '1';
    }, 300);
}

function showNoQuestionsMessage() {
    let message = '';
    if (isSearchActive) {
        message = 'No questions match your search criteria. Try different keywords.';
    } else if (selectedCategories.length === 0) {
        message = 'No categories selected. Please select categories from the sidebar.';
    } else {
        message = 'No questions available for the selected categories.';
    }
    
    quizContainer.innerHTML = `
        <div class="no-questions" style="text-align: center; padding: 80px 20px;">
            <div style="font-size: 64px; color: var(--text-tertiary); margin-bottom: 24px; opacity: 0.5;">
                <i class="fas fa-inbox"></i>
            </div>
            <h2 style="font-size: 28px; margin-bottom: 16px; color: var(--text-primary);">No Questions Available</h2>
            <p style="color: var(--text-secondary); margin-bottom: 32px; max-width: 400px; margin-left: auto; margin-right: auto;">
                ${message}
            </p>
            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                <button class="quiz-btn" onclick="toggleSidebar()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 12px 24px; border-radius: 12px;">
                    <i class="fas fa-folder-open"></i>
                    Select Categories
                </button>
                <button class="quiz-btn" onclick="showCustomQuestionCreator()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 12px 24px; border-radius: 12px;">
                    <i class="fas fa-plus"></i>
                    Create Question
                </button>
                ${isSearchActive ? `
                    <button class="quiz-btn" onclick="clearSearch()" style="background: linear-gradient(135deg, var(--secondary), #4b5563); color: white; padding: 12px 24px; border-radius: 12px;">
                        <i class="fas fa-times"></i>
                        Clear Search
                    </button>
                ` : ''}
            </div>
        </div>
    `;
    resultsScreen.classList.add('hidden');
    stopTimer();
    quizContainer.style.opacity = '1';
}

function startTimer() {
    if (timerInterval) clearInterval(timerInterval);
    startTime = new Date();
    timerInterval = setInterval(() => {
        if (isCountdown) {
            remainingTime--;
            if (remainingTime <= 0) {
                remainingTime = 0;
                clearInterval(timerInterval);
                if (currentMode === 'exam' && !examSubmitted) {
                    showNotification('Time up! Submitting exam.', 'error');
                    submitExam();
                }
            }
            updateTimerDisplay(formatTime(remainingTime), 'timerDisplay', true);
        } else {
            questionTimers[currentQuestionIndex]++;
            updateTimerDisplay(formatTime(questionTimers[currentQuestionIndex]), 'timerDisplay', false);
        }
    }, 1000);
}

function formatTime(seconds) {
    const min = Math.floor(seconds / 60).toString().padStart(2, '0');
    const sec = (seconds % 60).toString().padStart(2, '0');
    return `${min}:${sec}`;
}

function updateTimerDisplay(time, id, isCountdown = false) {
    const el = document.getElementById(id);
    if (el) {
        el.textContent = `Time: ${time}`;
        if (isCountdown) {
            el.classList.remove('timer-warning', 'timer-error');
            if (remainingTime <= 30) {
                el.classList.add('timer-error');
            } else if (remainingTime <= 60) {
                el.classList.add('timer-warning');
            }
        }
    }
}

function stopTimer() {
    if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
        if (startTime) {
            const endTime = new Date();
            const timeSpent = Math.floor((endTime - startTime) / 1000 / 60);
            userStats.timeSpent += timeSpent;
            userStats.lastActive = new Date().toISOString();
            saveUserData();
            updateDashboardStats();
        }
    }
}

function renderQuizLayout() {
    if (questions.length === 0) {
        showNoQuestionsMessage();
        return;
    }
    
    if (currentMode === 'exam') {
        renderExamLayout();
    } else {
        renderSingleQuestionLayout();
    }
}

function renderExamLayout() {
    const isImmediateMode = examCheckMode === 'immediate';
    quizContainer.innerHTML = `
        <div class="exam-header" style="margin-bottom: 24px; padding: 20px; background: var(--surface); border-radius: var(--radius); border: 1px solid var(--border);">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                <div>
                    <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">
                        Exam Mode: ${questions.length} Questions
                    </h3>
                    <p style="color: var(--text-secondary); font-size: 14px;">
                        ${isImmediateMode ?
                          'Immediate Check - See explanations as you answer' :
                          'All-in-One Check - Check all answers at the end'}
                    </p>
                </div>
                <div class="exam-mode-toggle" style="display: flex; gap: 8px; background: var(--glass); padding: 4px; border-radius: var(--radius);">
                    <button class="mode-toggle-btn ${isImmediateMode ? 'active' : ''}" data-mode="immediate" style="padding: 8px 16px; border: none; border-radius: 6px; background: ${isImmediateMode ? 'var(--primary)' : 'transparent'}; color: ${isImmediateMode ? 'white' : 'var(--text-secondary)'}; cursor: pointer; font-size: 12px; font-weight: 500;" aria-label="Immediate Check Mode">
                        Immediate Check
                    </button>
                    <button class="mode-toggle-btn ${!isImmediateMode ? 'active' : ''}" data-mode="all-at-once" style="padding: 8px 16px; border: none; border-radius: 6px; background: ${!isImmediateMode ? 'var(--primary)' : 'transparent'}; color: ${!isImmediateMode ? 'white' : 'var(--text-secondary)'}; cursor: pointer; font-size: 12px; font-weight: 500;" aria-label="All-at-Once Check Mode">
                        Check All
                    </button>
                </div>
            </div>
            <div class="progress-info" style="display: flex; align-items: center; gap: 16px;">
                <span style="font-size: 14px; color: var(--text-secondary);" id="answeredCount">0/${questions.length} answered</span>
                <div class="progress-bar" style="flex: 1; height: 6px;">
                    <div class="progress-fill" id="examProgressFill" style="width: 0%"></div>
                </div>
                <span id="timerDisplay" style="font-size: 14px; color: var(--text-secondary);">Time: ${formatTime(remainingTime)}</span>
                ${examSubmitted ? `<span style="color: var(--success); font-weight: 600; font-size: 14px;">Submitted!</span>` : ''}
            </div>
        </div>
        <div class="exam-mode-layout">
            ${questions.map((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.answer;
                const showExplanationButton = examSubmitted || (isImmediateMode && userAnswer !== undefined);
                return `
                    <div class="question-card fade-in" data-question-index="${index}" id="question-${question.id}">
                        <div class="question-header">
                            <div class="question-meta">
                                <div class="question-number">Q${question.id}</div>
                                <div class="question-category">${question.category}</div>
                                <div class="question-difficulty" style="background: ${getDifficultyColor(question.difficulty)};">
                                    ${question.difficulty}
                                </div>
                                ${userAnswer !== undefined ? `
                                    <div class="answer-status ${isCorrect ? 'correct' : 'incorrect'}" style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; background: ${isCorrect ? 'var(--success)' : 'var(--error)'}; color: white;">
                                        ${isCorrect ? 'Correct' : 'Incorrect'}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="question-actions">
                                <button class="action-btn bookmark-btn" data-question-id="${question.id}" aria-label="Bookmark Question">
                                    <i class="${bookmarkedQuestions.has(question.id) ? 'fas' : 'far'} fa-bookmark"></i>
                                </button>
                            </div>
                        </div>
                        <div class="question-image-container">
                            ${question.image ? `<img src="${question.image}" alt="Question image" class="question-image">` : ''}
                        </div>
                        <div class="question-text">${marked.parse(question.question)}</div>
                        <div class="options-grid">
                            ${question.options.map((option, optIndex) => {
                                const isSelected = userAnswer === optIndex;
                                const isCorrectOption = optIndex === question.answer;
                                let optionClass = 'option';
                                if (userAnswer !== undefined) {
                                    if (isCorrectOption) {
                                        optionClass += ' correct';
                                    } else if (isSelected && !isCorrectOption) {
                                        optionClass += ' incorrect';
                                    }
                                    optionClass += ' disabled';
                                } else if (isSelected) {
                                    optionClass += ' selected';
                                }
                                return `
                                    <div class="${optionClass}" data-option-index="${optIndex}" role="button" aria-label="Option ${String.fromCharCode(65 + optIndex)}">
                                        <div class="option-letter">${String.fromCharCode(65 + optIndex)}</div>
                                        <div class="option-text">${option}</div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        ${showExplanationButton ? `
                            <div class="explanation-section">
                                <details open>
                                    <summary><i class="fas fa-info-circle"></i> Correct Answer</summary>
                                    <div class="explanation-content correct-answer">
                                        <strong>Answer: ${String.fromCharCode(65 + question.answer)}. ${question.correctAnswer}</strong>
                                    </div>
                                </details>
                                ${userAnswer !== undefined && userAnswer !== question.answer ? `
                                    <details>
                                        <summary><i class="fas fa-exclamation-circle"></i> Why Not Your Answer?</summary>
                                        <div class="explanation-content why-not-section">
                                            <strong>Why not ${String.fromCharCode(65 + userAnswer)}?</strong>
                                            <p>${question.whyNotOtherOptions[String.fromCharCode(97 + userAnswer)]}</p>
                                        </div>
                                    </details>
                                ` : ''}
                                <details>
                                    <summary><i class="fas fa-book"></i> Detailed Explanation</summary>
                                    <div class="explanation-content">${question.explanation}</div>
                                </details>
                                <details>
                                    <summary><i class="fas fa-link"></i> Related Questions</summary>
                                    <div class="explanation-content related-questions">
                                        <div class="related-questions-list">
                                            ${question.relatedQuestions.map(q => {
                                                const qId = q.match(/\d+/)[0];
                                                return `<span class="related-question-tag" onclick="jumpToQuestion('question-${qId}')" role="button" aria-label="Jump to Question ${qId}">Q${qId}</span>`;
                                            }).join('')}
                                        </div>
                                    </div>
                                </details>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('')}
            <div class="quiz-controls">
                <div style="display: flex; gap: 12px;">
                    ${examCheckMode === 'all-at-once' && !examSubmitted ? `
                        <button class="quiz-btn check-btn" id="checkAllBtn" ${userAnswers.filter(a => a !== undefined).length === 0 ? 'disabled' : ''} aria-label="Check All Answers">
                            <i class="fas fa-check-double"></i>
                            Check All Answers
                        </button>
                    ` : ''}
                </div>
                <button class="quiz-btn submit-btn" id="examSubmitBtn" ${examSubmitted ? 'disabled' : ''} aria-label="Submit Exam">
                    <i class="fas fa-paper-plane"></i>
                    ${examSubmitted ? 'Exam Submitted' : `Submit Exam (${questions.length} questions)`}
                </button>
            </div>
        </div>
    `;
    initializeExamModeEvents();
    updateExamSubmitButton();
}

function renderSingleQuestionLayout() {
    if (currentQuestionIndex >= questions.length) {
        showResults();
        return;
    }
    const question = questions[currentQuestionIndex];
    const userAnswer = userAnswers[currentQuestionIndex];
    const isCorrect = userAnswer === question.answer;
    quizContainer.innerHTML = `
        <div class="question-card fade-in" data-question-index="${currentQuestionIndex}">
            <div class="question-header">
                <div class="question-meta">
                    <div class="question-number">Q${question.id}</div>
                    <div class="question-category">${question.category}</div>
                    <div class="question-difficulty" style="background: ${getDifficultyColor(question.difficulty)};">
                        ${question.difficulty}
                    </div>
                    ${userAnswer !== undefined ? `
                        <div class="answer-status ${isCorrect ? 'correct' : 'incorrect'}" style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; background: ${isCorrect ? 'var(--success)' : 'var(--error)'}; color: white;">
                            ${isCorrect ? 'Correct' : 'Incorrect'}
                        </div>
                    ` : ''}
                </div>
                <div class="question-actions">
                    <button class="action-btn bookmark-btn" data-question-id="${question.id}" aria-label="Bookmark Question">
                        <i class="${bookmarkedQuestions.has(question.id) ? 'fas' : 'far'} fa-bookmark"></i>
                    </button>
                </div>
            </div>
            <div class="question-image-container">
                ${question.image ? `<img src="${question.image}" alt="Question image" class="question-image">` : ''}
            </div>
            <div class="question-text">${marked.parse(question.question)}</div>
            <div class="options-grid">
                ${question.options.map((option, index) => {
                    const isSelected = userAnswer === index;
                    const isCorrectOption = index === question.answer;
                    let optionClass = 'option';
                    if (isAnswerChecked) {
                        if (isCorrectOption) {
                            optionClass += ' correct';
                        } else if (isSelected && !isCorrectOption) {
                            optionClass += ' incorrect';
                        }
                        optionClass += ' disabled';
                    } else if (isSelected) {
                        optionClass += ' selected';
                    }
                    return `
                        <div class="${optionClass}" data-option-index="${index}" role="button" aria-label="Option ${String.fromCharCode(65 + index)}">
                            <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                            <div class="option-text">${option}</div>
                        </div>
                    `;
                }).join('')}
            </div>
            ${isAnswerChecked ? `
                <div class="explanation-section">
                    <details open>
                        <summary><i class="fas fa-info-circle"></i> Correct Answer</summary>
                        <div class="explanation-content correct-answer">
                            <strong>Answer: ${String.fromCharCode(65 + question.answer)}. ${question.correctAnswer}</strong>
                        </div>
                    </details>
                    ${userAnswer !== undefined && userAnswer !== question.answer ? `
                        <details>
                            <summary><i class="fas fa-exclamation-circle"></i> Why Not Your Answer?</summary>
                            <div class="explanation-content why-not-section">
                                <strong>Why not ${String.fromCharCode(65 + userAnswer)}?</strong>
                                <p>${question.whyNotOtherOptions[String.fromCharCode(97 + userAnswer)]}</p>
                            </div>
                        </details>
                    ` : ''}
                    <details>
                        <summary><i class="fas fa-book"></i> Detailed Explanation</summary>
                        <div class="explanation-content">${question.explanation}</div>
                    </details>
                    <details>
                        <summary><i class="fas fa-link"></i> Related Questions</summary>
                        <div class="explanation-content related-questions">
                            <div class="related-questions-list">
                                ${question.relatedQuestions.map(q => {
                                    const qId = q.match(/\d+/)[0];
                                    return `<span class="related-question-tag" onclick="jumpToQuestion('question-${qId}')" role="button" aria-label="Jump to Question ${qId}">Q${qId}</span>`;
                                }).join('')}
                            </div>
                        </div>
                    </details>
                </div>
            ` : ''}
            <div class="quiz-controls">
                <div style="display: flex; gap: 12px;">
                    <button class="quiz-btn check-btn" id="checkAnswerBtn" ${userAnswer === undefined ? 'disabled' : ''} aria-label="Check Answer">
                        <i class="fas fa-check"></i>
                        Check Answer
                    </button>
                    ${currentMode === 'learn' && incorrectQuestions.length > 0 ? `
                        <button class="quiz-btn" id="incorrectOnlyBtn" aria-label="Show Incorrect Only">
                            <i class="fas fa-filter"></i>
                            Incorrect Only
                        </button>
                    ` : ''}
                </div>
                <button class="quiz-btn next-btn" id="nextQuestionBtn" ${!isAnswerChecked ? 'disabled' : ''} aria-label="Next Question">
                    <i class="fas fa-arrow-right"></i>
                    ${currentQuestionIndex < questions.length - 1 ? 'Next Question' : 'Finish'}
                </button>
            </div>
        </div>
    `;
    initializeQuizEvents();
    updateTimerDisplay(formatTime(isCountdown ? remainingTime : questionTimers[currentQuestionIndex]), 'timerDisplay', isCountdown);
}

function initializeQuizEvents() {
    const checkAnswerBtn = document.getElementById('checkAnswerBtn');
    const nextQuestionBtn = document.getElementById('nextQuestionBtn');
    const incorrectOnlyBtn = document.getElementById('incorrectOnlyBtn');
    const bookmarkBtn = document.querySelector('.bookmark-btn');
    const options = document.querySelectorAll('.option:not(.disabled)');
    
    options.forEach(option => {
        option.addEventListener('click', () => {
            if (!isAnswerChecked) {
                options.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                userAnswers[currentQuestionIndex] = parseInt(option.dataset.optionIndex);
                if (checkAnswerBtn) checkAnswerBtn.disabled = false;
                updateExamSubmitButton();
            }
        });
    });
    
    if (checkAnswerBtn) {
        checkAnswerBtn.addEventListener('click', () => {
            checkAnswer();
            renderQuizLayout();
        });
    }
    
    if (nextQuestionBtn) {
        nextQuestionBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            isAnswerChecked = false;
            renderQuizLayout();
        });
    }
    
    if (incorrectOnlyBtn) {
        incorrectOnlyBtn.addEventListener('click', () => {
            questions = quizData.filter(q => incorrectQuestions.includes(q.id));
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length);
            isAnswerChecked = false;
            renderQuizLayout();
        });
    }
    
    if (bookmarkBtn) {
        bookmarkBtn.addEventListener('click', () => {
            const questionId = parseInt(bookmarkBtn.dataset.questionId);
            toggleBookmark(questionId);
            bookmarkBtn.querySelector('i').className = bookmarkedQuestions.has(questionId) ? 'fas fa-bookmark' : 'far fa-bookmark';
        });
    }
}

function initializeExamModeEvents() {
    const options = document.querySelectorAll('.option:not(.disabled)');
    const checkAllBtn = document.getElementById('checkAllBtn');
    const submitBtn = document.getElementById('examSubmitBtn');
    const modeToggleButtons = document.querySelectorAll('.mode-toggle-btn');
    
    options.forEach(option => {
        option.addEventListener('click', () => {
            const questionIndex = parseInt(option.closest('.question-card').dataset.questionIndex);
            const prevSelected = option.closest('.options-grid').querySelector('.selected');
            if (prevSelected) prevSelected.classList.remove('selected');
            option.classList.add('selected');
            userAnswers[questionIndex] = parseInt(option.dataset.optionIndex);
            updateExamProgress();
            updateExamSubmitButton();
            if (examCheckMode === 'immediate') {
                checkAnswer(questionIndex);
                renderQuizLayout();
            }
        });
    });
    
    if (checkAllBtn) {
        checkAllBtn.addEventListener('click', () => {
            userAnswers.forEach((answer, index) => {
                if (answer !== undefined) {
                    checkAnswer(index);
                }
            });
            renderQuizLayout();
        });
    }
    
    if (submitBtn) {
        submitBtn.addEventListener('click', submitExam);
    }
    
    modeToggleButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            modeToggleButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            examCheckMode = btn.dataset.mode;
            renderQuizLayout();
        });
    });
    
    document.querySelectorAll('.bookmark-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const questionId = parseInt(btn.dataset.questionId);
            toggleBookmark(questionId);
            btn.querySelector('i').className = bookmarkedQuestions.has(questionId) ? 'fas fa-bookmark' : 'far fa-bookmark';
        });
    });
}

function updateExamProgress() {
    const answered = userAnswers.filter(a => a !== undefined).length;
    const progressPercent = (answered / questions.length) * 100;
    const answeredCount = document.getElementById('answeredCount');
    const progressFill = document.getElementById('examProgressFill');
    if (answeredCount) {
        answeredCount.textContent = `${answered}/${questions.length} answered`;
    }
    if (progressFill) {
        progressFill.style.width = `${progressPercent}%`;
    }
}

function updateExamSubmitButton() {
    const submitBtn = document.getElementById('examSubmitBtn');
    if (submitBtn) {
        const allAnswered = userAnswers.every(a => a !== undefined);
        submitBtn.disabled = !allAnswered || examSubmitted;
        submitBtn.innerHTML = examSubmitted ?
            '<i class="fas fa-paper-plane"></i> Exam Submitted' :
            `<i class="fas fa-paper-plane"></i> Submit Exam (${questions.length} questions)`;
    }
}

function checkAnswer(questionIndex = currentQuestionIndex) {
    const question = questions[questionIndex];
    const userAnswer = userAnswers[questionIndex];
    isAnswerChecked = true;
    if (userAnswer === question.answer) {
        score++;
        userStats.correctAnswers++;
        if (!userProgress[question.id]) userProgress[question.id] = { correct: 0, attempts: 0 };
        userProgress[question.id].correct++;
        userProgress[question.id].attempts++;
        incorrectQuestions = incorrectQuestions.filter(id => id !== question.id);
    } else {
        if (!incorrectQuestions.includes(question.id)) {
            incorrectQuestions.push(question.id);
        }
        if (!userProgress[question.id]) userProgress[question.id] = { correct: 0, attempts: 0 };
        userProgress[question.id].attempts++;
    }
    userStats.totalQuestions++;
    userStats.masteryLevel = calculateMasteryLevel();
    saveUserData();
    updateDashboardStats();
}

function submitExam() {
    examSubmitted = true;
    if (examCheckMode === 'all-at-once') {
        userAnswers.forEach((answer, index) => {
            if (answer !== undefined) {
                checkAnswer(index);
            }
        });
    }
    stopTimer();
    showResults();
}

function calculateMasteryLevel() {
    const masteredQuestions = Object.values(userProgress).filter(p => p.correct >= 3).length;
    return quizData.length > 0 ? Math.round((masteredQuestions / quizData.length) * 100) : 0;
}

function showResults() {
    stopTimer();
    quizContainer.classList.add('hidden');
    resultsScreen.classList.remove('hidden');
    const percentage = questions.length > 0 ? Math.round((score / questions.length) * 100) : 0;
    
    let restartText = 'Restart Quiz';
    if (currentPage === 'bookmarks') {
        restartText = 'Practice Again';
    }
    
    resultsScreen.innerHTML = `
        <div class="results-card fade-in">
            <div class="results-header">
                <h2 class="results-title">${currentMode.charAt(0).toUpperCase() + currentMode.slice(1)} Results</h2>
                <p class="score-text">You completed ${questions.length} question${questions.length !== 1 ? 's' : ''}</p>
            </div>
            <div class="score-display">${percentage}%</div>
            <div class="score-text">Score: ${score} out of ${questions.length} correct</div>
            <div class="results-details">
                ${questions.map((q, index) => {
                    const isCorrect = userAnswers[index] === q.answer;
                    return `
                        <div class="result-item">
                            <div class="result-question">Q${q.id}: ${q.question}</div>
                            <div class="result-status ${isCorrect ? 'result-correct' : 'result-incorrect'}">
                                ${isCorrect ? 'Correct' : 'Incorrect'}
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
            <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                <button class="restart-btn" id="restartQuiz" aria-label="Restart Quiz" style="margin: 0;">
                    <i class="fas fa-redo"></i>
                    ${restartText}
                </button>
                ${currentPage === 'bookmarks' ? `
                    <button class="quiz-btn" onclick="showBookmarks()" style="background: linear-gradient(135deg, var(--secondary), #4b5563); color: white; padding: 16px 24px; border-radius: var(--radius);">
                        <i class="fas fa-bookmark"></i>
                        Back to Bookmarks
                    </button>
                ` : ''}
            </div>
        </div>
    `;
    
    document.getElementById('restartQuiz').addEventListener('click', () => {
        if (currentPage === 'bookmarks') {
            startBookmarksQuiz();
        } else {
            startQuiz();
        }
    });
}

function toggleBookmark(questionId) {
    if (bookmarkedQuestions.has(questionId)) {
        bookmarkedQuestions.delete(questionId);
        showNotification('Question removed from bookmarks', 'info');
    } else {
        bookmarkedQuestions.add(questionId);
        showNotification('Question bookmarked', 'success');
    }
    saveUserData();
    
    // If we're on the bookmarks page, refresh it
    if (currentPage === 'bookmarks') {
        showBookmarks();
    }
}


function getDifficultyColor(difficulty) {
    switch (difficulty.toLowerCase()) {
        case 'easy': return '#10b981';
        case 'medium': return '#f59e0b';
        case 'hard': return '#ef4444';
        default: return '#64748b';
    }
}

function jumpToQuestion(questionId) {
    const questionIndex = questions.findIndex(q => `question-${q.id}` === questionId);
    if (questionIndex !== -1) {
        if (currentMode === 'exam') {
            const element = document.getElementById(questionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        } else {
            currentQuestionIndex = questionIndex;
            isAnswerChecked = false;
            renderQuizLayout();
        }
    } else {
        // If question not in current quiz, start a new quiz with that question's category
        const question = quizData.find(q => `question-${q.id}` === questionId) || customQuestions.find(q => `question-${q.id}` === questionId);
        if (question) {
            selectedCategories = [question.category];
            startQuiz();
            setTimeout(() => {
                const element = document.getElementById(questionId);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 500);
        }
    }
}

// Initialize the application
init();
    </script>
</body>

</html>